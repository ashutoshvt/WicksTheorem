import numpy as np


def construct_transcorr_H(H_1body, H_2body, info):

    # Getting parameters!
    ngen = info[0]
    nocc = info[1]
    nvir = info[2]
    H1_gg = info[3]
    H1_gc = info[4]
    F1_gg = info[5]
    F1_gc = info[6]
    F1_cc = info[7]
    V2_gg_gg = info[8]
    V2_gg_gc = info[9]
    R2_oo_vc = info[10]
    V_F12_oo_gg = info[11]
    X_F12_oo_oo = info[12]
    B_F12_oo_oo = info[13]
    R1 = info[14]
    R2_abxy = info[15]
    R2_aixy = info[16]
    V2_gg_cc = info[17]

    # slices !!
    slice_o = slice(0, nocc)
    slice_v = slice(nocc, ngen)

    # Einsum expressions!!
    #  H1_R2  
    H_2body[:, slice_v, slice_o, slice_o] += 0.5 * np.einsum('px,jibx->pbij', H1_gc[:, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += 0.5 * np.einsum('py,ijay->paji', H1_gc[:, :], R2_oo_vc)
    #  H1_R2D  
    H_2body[slice_o, slice_o, slice_v, :] += 0.5 * np.einsum('ijay,qy->ijaq', R2_oo_vc, H1_gc[:, :])
    H_2body[slice_o, slice_o, :, slice_v] += 0.5 * np.einsum('jibx,qx->ijqb', R2_oo_vc, H1_gc[:, :])
    #  F1_R2_R2  
    #  F1_R2_R2D  
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('kicz,zx,jibx->kbcj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('jicz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ilcz,zx,jibx->lbcj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ijcz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('jlcz,zx,jibx->lbci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('jicz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('kjcz,zx,jibx->kbci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ijcz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ijcz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('jicz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.125 * np.einsum('kjcz,pa,ijaz->kpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('kjcz,ia,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('ijcz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += 0.125 * np.einsum('klcz,ia,ijaz->klcj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('kjcz,ia,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jlcz,ia,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('kjcz,ia,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('kicz,ja,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('jlcz,pa,ijaz->lpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jlcz,ia,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('jicz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('ilcz,pa,ijaz->lpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ilcz,ja,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('ijcz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('kicz,pa,ijaz->kpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('kicz,ja,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('jicz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.0625 * np.einsum('klcz,ja,ijaz->klci', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('kicz,ja,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('ilcz,ja,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jlcz,ia,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.03125 * np.einsum('ilcz,ja,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.0625 * np.einsum('jicz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.03125 * np.einsum('ijcz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('lidw,wx,jibx->lbdj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('jidw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('ljdw,wx,jibx->lbid', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ijdw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ikdw,wx,jibx->kbdj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ijdw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('jkdw,wx,jibx->kbid', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('jidw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('jidw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ijdw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.125 * np.einsum('ljdw,pa,ijaw->lpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('ljdw,ia,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('ijdw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += 0.125 * np.einsum('lkdw,ia,ijaw->kljd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('ljdw,ia,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jkdw,ia,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ljdw,ia,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('lidw,ja,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.0625 * np.einsum('lidw,pa,ijaw->lpjd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('jidw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('lidw,ja,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('jkdw,pa,ijaw->kpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jkdw,ia,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('jidw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.0625 * np.einsum('ikdw,pa,ijaw->kpjd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('ijdw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('ikdw,ja,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.0625 * np.einsum('lkdw,ja,ijaw->kldi', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ikdw,ja,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('lidw,ja,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jkdw,ia,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.03125 * np.einsum('ikdw,ja,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijdw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.03125 * np.einsum('jidw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('lkij->lkji', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('klij->klij', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('kjcz,zy,ijay->kaci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ijcz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('jlcz,zy,ijay->laci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('jicz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ilcz,zy,ijay->lacj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ijcz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('kicz,zy,ijay->kacj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('jicz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('jicz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ijcz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.125 * np.einsum('kicz,pb,jibz->kpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('kicz,jb,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('jicz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += 0.125 * np.einsum('klcz,jb,jibz->klci', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('kicz,jb,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ilcz,jb,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('kicz,jb,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('kjcz,ib,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('ilcz,pb,jibz->lpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ilcz,jb,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('ijcz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('jlcz,pb,jibz->lpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jlcz,ib,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('jicz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('kjcz,pb,jibz->kpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('kjcz,ib,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('ijcz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.0625 * np.einsum('klcz,ib,jibz->klcj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('kjcz,ib,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('jlcz,ib,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('ilcz,jb,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.03125 * np.einsum('jlcz,ib,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijcz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.03125 * np.einsum('jicz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ljdw,wy,ijay->ladi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ijdw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('lidw,wy,ijay->lajd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('jidw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('jkdw,wy,ijay->kadi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('jidw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('ikdw,wy,ijay->kajd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ijdw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ijdw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('jidw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.125 * np.einsum('lidw,pb,jibw->lpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('lidw,jb,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('jidw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += 0.125 * np.einsum('lkdw,jb,jibw->klid', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('lidw,jb,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ikdw,jb,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('lidw,jb,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('ljdw,ib,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.0625 * np.einsum('ljdw,pb,jibw->lpid', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('ijdw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('ljdw,ib,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.0625 * np.einsum('ikdw,pb,jibw->kpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ikdw,jb,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.03125 * np.einsum('ijdw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.0625 * np.einsum('jkdw,pb,jibw->kpid', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.0625 * np.einsum('jidw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('jkdw,ib,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.0625 * np.einsum('lkdw,ib,jibw->kldj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jkdw,ib,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.03125 * np.einsum('ljdw,ib,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('ikdw,jb,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.03125 * np.einsum('jkdw,ib,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += -0.0625 * np.einsum('jidw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[:, slice_v] += 0.03125 * np.einsum('ijdw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('lkji->lkji', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('klji->klij', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_v, :] += -0.125 * np.einsum('kicz,jibz,jq->kbcq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('kicz,jibz,jk->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('ilcz,jibz,jq->lbcq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ilcz,jibz,jl->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('klcz,jibz,jk->lbci', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kicz,jibz,jk->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('klcz,jibz,jl->kbci', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ilcz,jibz,jl->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ilcz,jibz,jl->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('kicz,jibz,jk->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('klcz,ijaz,jl->kaci', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ilcz,ijaz,jl->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('klcz,ijaz,jk->laci', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kicz,ijaz,jk->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('ilcz,ijaz,jq->lacq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ilcz,ijaz,jl->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('kicz,ijaz,jq->kacq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kicz,ijaz,jk->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('kicz,ijaz,jk->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ilcz,ijaz,jl->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += -0.125 * np.einsum('lidw,jibw,jq->lbdq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lidw,jibw,jl->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('lkdw,jibw,jk->lbid', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ikdw,jibw,jk->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('ikdw,jibw,jq->kbdq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ikdw,jibw,jk->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('lkdw,jibw,jl->kbid', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lidw,jibw,jl->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lidw,jibw,jl->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ikdw,jibw,jk->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('lkdw,ijaw,jk->ladi', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ikdw,ijaw,jk->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, :, slice_v] += 0.0625 * np.einsum('lidw,ijaw,jq->laqd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lidw,ijaw,jl->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('lkdw,ijaw,jl->kadi', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lidw,ijaw,jl->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, :, slice_v] += 0.0625 * np.einsum('ikdw,ijaw,jq->kaqd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ikdw,ijaw,jk->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ikdw,ijaw,jk->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lidw,ijaw,jl->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_o, :, slice_o] += -0.125 * np.einsum('jq,klji->klqi', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, :] += -0.125 * np.einsum('jq,klij->kliq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('klcz,jibz,il->kbcj', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('jlcz,jibz,il->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('klcz,jibz,ik->lbcj', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kjcz,jibz,ik->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('jlcz,jibz,iq->lbcq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('jlcz,jibz,il->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('kjcz,jibz,iq->kbcq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kjcz,jibz,ik->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('kjcz,jibz,ik->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('jlcz,jibz,il->bc', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += -0.125 * np.einsum('kjcz,ijaz,iq->kacq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('kjcz,ijaz,ik->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('jlcz,ijaz,iq->lacq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('jlcz,ijaz,il->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('klcz,ijaz,ik->lacj', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kjcz,ijaz,ik->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('klcz,ijaz,il->kacj', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('jlcz,ijaz,il->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('jlcz,ijaz,il->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('kjcz,ijaz,ik->ac', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('lkdw,jibw,ik->lbdj', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('jkdw,jibw,ik->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, :, slice_v] += 0.0625 * np.einsum('ljdw,jibw,iq->lbqd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ljdw,jibw,il->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('lkdw,jibw,il->kbdj', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ljdw,jibw,il->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, :, slice_v] += 0.0625 * np.einsum('jkdw,jibw,iq->kbqd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('jkdw,jibw,ik->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('jkdw,jibw,ik->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ljdw,jibw,il->bd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += -0.125 * np.einsum('ljdw,ijaw,iq->ladq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ljdw,ijaw,il->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('lkdw,ijaw,ik->lajd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('jkdw,ijaw,ik->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_v, :] += 0.0625 * np.einsum('jkdw,ijaw,iq->kadq', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, :])
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('jkdw,ijaw,ik->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('lkdw,ijaw,il->kajd', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ljdw,ijaw,il->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ljdw,ijaw,il->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('jkdw,ijaw,ik->ad', R2_oo_vc, R2_oo_vc, F1_gg[slice_o, slice_o])
    H_2body[slice_o, slice_o, slice_o, :] += -0.125 * np.einsum('iq,klji->kljq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_o, :, slice_o] += -0.125 * np.einsum('iq,klij->klqj', F1_gg[slice_o, :], X_F12_oo_oo)
    #  F1_R2D_R2  
    H_2body[:, slice_v, slice_v, slice_o] += -0.125 * np.einsum('pi,ikay,lkdy->pdal', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('li,ikay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('ki,ijay,lkdy->jdal', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ki,ilay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('li,ijay,lkdy->jdak', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('li,ikay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pi,ilay,lkdy->pdak', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ki,ilay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ki,ilay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('li,ikay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.125 * np.einsum('pi,ilay,klcy->pcak', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ki,ilay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('li,ijay,klcy->jcak', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('li,ikay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('ki,ijay,klcy->jcal', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ki,ilay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pi,ikay,klcy->pcal', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('li,ikay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('li,ikay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ki,ilay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ki,jibx,lkdx->jdbl', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ki,libx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('li,jibx,lkdx->jdkb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('li,kibx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pi,kibx,lkdx->pdbl', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('li,kibx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('pi,libx,lkdx->pdkb', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ki,libx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('ki,libx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('li,kibx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('li,jibx,klcx->jcbk', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('li,kibx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('ki,jibx,klcx->jclb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('ki,libx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pi,libx,klcx->pcbk', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('ki,libx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('pi,kibx,klcx->pclb', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('li,kibx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('li,kibx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('ki,libx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_o, slice_o, slice_o] += -0.125 * np.einsum('pi,ijlk->pjlk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_2body[:, slice_o, slice_o, slice_o] += -0.125 * np.einsum('pi,ijkl->pjkl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_2body[:, slice_v, slice_v, slice_o] += -0.125 * np.einsum('pj,jkbx,lkdx->pdbl', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lj,jkbx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('kj,jibx,lkdx->idbl', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kj,jlbx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('lj,jibx,lkdx->idbk', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lj,jkbx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pj,jlbx,lkdx->pdbk', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kj,jlbx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('kj,jlbx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lj,jkbx,lkdx->db', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.125 * np.einsum('pj,jlbx,klcx->pcbk', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('kj,jlbx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('lj,jibx,klcx->icbk', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lj,jkbx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('kj,jibx,klcx->icbl', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kj,jlbx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pj,jkbx,klcx->pcbl', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lj,jkbx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lj,jkbx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('kj,jlbx,klcx->cb', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('kj,ijay,lkdy->idal', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('kj,ljay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('lj,ijay,lkdy->idka', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lj,kjay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pj,kjay,lkdy->pdal', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lj,kjay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('pj,ljay,lkdy->pdka', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('kj,ljay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('kj,ljay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lj,kjay,lkdy->da', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('lj,ijay,klcy->icak', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lj,kjay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('kj,ijay,klcy->icla', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('kj,ljay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.0625 * np.einsum('pj,ljay,klcy->pcak', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('kj,ljay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += 0.0625 * np.einsum('pj,kjay,klcy->pcla', F1_gg[:, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lj,kjay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lj,kjay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('kj,ljay,klcy->ca', F1_gg[slice_o, slice_o], R2_oo_vc, R2_oo_vc)
    H_2body[:, slice_o, slice_o, slice_o] += -0.125 * np.einsum('pj,ijkl->pilk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_2body[:, slice_o, slice_o, slice_o] += -0.125 * np.einsum('pj,ijlk->pikl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ikay,yw,lkdw->idal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lkay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('kjay,yw,lkdw->jdal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('klay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ljay,yw,lkdw->jdak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lkay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ilay,yw,lkdw->idak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('klay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('klay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lkay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ilay,yz,klcz->icak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('klay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ljay,yz,klcz->jcak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lkay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('kjay,yz,klcz->jcal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('klay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('ikay,yz,klcz->ical', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lkay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lkay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('klay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.125 * np.einsum('jkbx,bq,lkdx->jdql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jkbx,bj,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('lkbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.125 * np.einsum('jibx,bj,lkdx->idkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jkbx,bj,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('jlbx,bj,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jkbx,bj,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('kibx,bi,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.0625 * np.einsum('jibx,bi,lkdx->jdkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('kibx,bi,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('libx,bi,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.0625 * np.einsum('jlbx,bq,lkdx->jdkq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('klbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('jlbx,bj,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('kibx,bq,lkdx->idql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('kibx,bi,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('klbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.0625 * np.einsum('libx,bq,lkdx->idkq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('lkbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('libx,bi,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('libx,bi,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.03125 * np.einsum('jlbx,bj,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('lkbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.03125 * np.einsum('klbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.125 * np.einsum('jlbx,bq,klcx->jcqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jlbx,bj,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('klbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.125 * np.einsum('jibx,bj,klcx->iclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jlbx,bj,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('jkbx,bj,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jlbx,bj,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('libx,bi,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.0625 * np.einsum('jibx,bi,klcx->jclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('libx,bi,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('kibx,bi,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.0625 * np.einsum('jkbx,bq,klcx->jclq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('lkbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('jkbx,bj,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('libx,bq,klcx->icqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('libx,bi,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('lkbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.0625 * np.einsum('kibx,bq,klcx->iclq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('klbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('kibx,bi,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('kibx,bi,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.03125 * np.einsum('jkbx,bj,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('klbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.03125 * np.einsum('lkbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('jikl->jilk', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('jilk->jilk', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.125 * np.einsum('ijay,ai,lkdy->jdkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('ikay,ai,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ilay,ai,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.125 * np.einsum('ikay,aq,lkdy->idql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('ikay,ai,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('lkay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('ikay,ai,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('kjay,aj,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('kjay,aq,lkdy->jdql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('kjay,aj,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('klay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('ljay,aq,lkdy->jdqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ljay,aj,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('lkay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.0625 * np.einsum('ijay,aj,lkdy->idkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('kjay,aj,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('ljay,aj,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('ilay,aq,lkdy->idqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ilay,ai,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('klay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('klay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.03125 * np.einsum('lkay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('ilay,ai,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.03125 * np.einsum('ljay,aj,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.125 * np.einsum('ijay,ai,klcy->jclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('ilay,ai,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ikay,ai,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.125 * np.einsum('ilay,aq,klcy->icqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('ilay,ai,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('klay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('ilay,ai,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('ljay,aj,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('ljay,aq,klcy->jcqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ljay,aj,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('lkay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('kjay,aq,klcy->jcql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('kjay,aj,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('klay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.0625 * np.einsum('ijay,aj,klcy->iclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ljay,aj,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.03125 * np.einsum('kjay,aj,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.0625 * np.einsum('ikay,aq,klcy->icql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('ikay,ai,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, :] += -0.03125 * np.einsum('lkay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('lkay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.03125 * np.einsum('klay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('ikay,ai,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.03125 * np.einsum('kjay,aj,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jkbx,xw,lkdw->jdbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lkbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('jlbx,xw,lkdw->jdkb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('klbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('kibx,xw,lkdw->idbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('klbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('libx,xw,lkdw->idkb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lkbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('lkbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('klbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jlbx,xz,klcz->jcbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('klbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('jkbx,xz,klcz->jclb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('lkbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.0625 * np.einsum('libx,xz,klcz->icbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.03125 * np.einsum('lkbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.0625 * np.einsum('kibx,xz,klcz->iclb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.0625 * np.einsum('klbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.0625 * np.einsum('klbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.03125 * np.einsum('lkbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('ijlk->ijkl', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += 0.0625 * np.einsum('ijkl->ijkl', B_F12_oo_oo)
    #  F1_R2D_R2D  
    #  V2_R2  
    H_2body[:, slice_v, slice_o, slice_o] += 0.25 * np.einsum('rqrx,jibx->qbij', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('rirx,jibx->bj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('rjrx,jibx->bi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.25 * np.einsum('pirx,jibx->pbrj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('rirx,jibx->bj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('jirx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.25 * np.einsum('rirx,jibx->bj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('irrx,jibx->bj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('iqrx,jibx->qbrj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('irrx,jibx->bj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('ijrx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('jqrx,jibx->qbri', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jrrx,jibx->bi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('jirx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += -0.125 * np.einsum('prrx,jibx->pbij', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('irrx,jibx->bj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('jrrx,jibx->bi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('pjrx,jibx->pbri', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('rjrx,jibx->bi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('ijrx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.125 * np.einsum('ijrx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('jirx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('rjrx,jibx->bi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('jrrx,jibx->bi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += 0.25 * np.einsum('rqry,ijay->qaji', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('rjry,ijay->ai', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('riry,ijay->aj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.25 * np.einsum('pjry,ijay->pari', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('rjry,ijay->ai', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('ijry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.25 * np.einsum('rjry,ijay->ai', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jrry,ijay->ai', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('jqry,ijay->qari', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jrry,ijay->ai', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('jiry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('iqry,ijay->qarj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('irry,ijay->aj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('ijry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += -0.125 * np.einsum('prry,ijay->paji', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jrry,ijay->ai', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('irry,ijay->aj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('piry,ijay->parj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('riry,ijay->aj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('jiry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.125 * np.einsum('jiry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('ijry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('riry,ijay->aj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('irry,ijay->aj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.25 * np.einsum('qisx,jibx->qbsj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('sisx,jibx->bj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('jisx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += 0.25 * np.einsum('spsx,jibx->pbij', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('sisx,jibx->bj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('sjsx,jibx->bi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.25 * np.einsum('sisx,jibx->bj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('issx,jibx->bj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += -0.125 * np.einsum('qssx,jibx->qbij', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('issx,jibx->bj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('jssx,jibx->bi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.125 * np.einsum('qjsx,jibx->qbis', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('ijsx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('sjsx,jibx->bi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('ipsx,jibx->pbsj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('issx,jibx->bj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('ijsx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.125 * np.einsum('jpsx,jibx->pbis', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('jisx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('jssx,jibx->bi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jssx,jibx->bi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('sjsx,jibx->bi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.125 * np.einsum('jisx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('ijsx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.25 * np.einsum('qjsy,ijay->qasi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('sjsy,ijay->ai', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('ijsy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += 0.25 * np.einsum('spsy,ijay->paji', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('sjsy,ijay->ai', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('sisy,ijay->aj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.25 * np.einsum('sjsy,ijay->ai', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('jssy,ijay->ai', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += -0.125 * np.einsum('qssy,ijay->qaji', V2_gg_gc[:, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jssy,ijay->ai', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('issy,ijay->aj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.125 * np.einsum('qisy,ijay->qajs', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('jisy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('sisy,ijay->aj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.125 * np.einsum('jpsy,ijay->pasi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('jssy,ijay->ai', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.0625 * np.einsum('jisy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.125 * np.einsum('ipsy,ijay->pajs', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('ijsy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.0625 * np.einsum('issy,ijay->aj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.125 * np.einsum('issy,ijay->aj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.0625 * np.einsum('sisy,ijay->aj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.125 * np.einsum('ijsy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.0625 * np.einsum('jisy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_2body[:, :, slice_o, slice_o] += 0.25 * np.einsum('ijqp->pqji', V_F12_oo_gg[:, :, :, :])
    H_2body[:, :, slice_o, slice_o] += 0.25 * np.einsum('ijpq->pqij', V_F12_oo_gg[:, :, :, :])
    #  V2_R2D  
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('ijay,sjqy->iqas', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ijay,sjsy->ia', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('ijay,ijqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, slice_v, :] += 0.25 * np.einsum('ijay,srsy->ijar', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ijay,sjsy->ia', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,sisy->ja', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.25 * np.einsum('ijay,sjsy->ia', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('ijay,jrry->ia', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('ijay,siqy->jqas', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,sisy->ja', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijay,jiqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('ijay,irqy->jqar', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,irry->ja', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijay,ijqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('ijay,jrqy->iqar', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,jrry->ia', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijay,jiqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, slice_v, :] += -0.125 * np.einsum('ijay,srry->ijas', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,jrry->ia', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('ijay,irry->ja', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('ijay,sisy->ja', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ijay,irry->ja', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.125 * np.einsum('ijay,jiqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.0625 * np.einsum('ijay,ijqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('ijay,rjpy->ipar', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ijay,rjry->ia', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('ijay,ijpy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, slice_v, :] += 0.25 * np.einsum('ijay,rsry->ijas', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ijay,rjry->ia', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,riry->ja', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.25 * np.einsum('ijay,rjry->ia', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('ijay,jssy->ia', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('ijay,ripy->jpar', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,riry->ja', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijay,jipy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('ijay,ispy->jpas', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,issy->ja', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijay,ijpy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('ijay,jspy->ipas', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,jssy->ia', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('ijay,jipy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, slice_v, :] += -0.125 * np.einsum('ijay,rssy->ijar', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ijay,jssy->ia', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('ijay,issy->ja', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('ijay,riry->ja', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('ijay,issy->ja', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.125 * np.einsum('ijay,jipy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.0625 * np.einsum('ijay,ijpy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('jibx,siqx->jqbs', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jibx,sisx->jb', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('jibx,jiqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, :, slice_v] += 0.25 * np.einsum('jibx,srsx->ijrb', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jibx,sisx->jb', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jibx,sjsx->ib', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.25 * np.einsum('jibx,sisx->jb', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('jibx,irrx->jb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.125 * np.einsum('jibx,irqx->jqrb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('jibx,ijqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jibx,irrx->jb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('jibx,sjqx->iqbs', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jibx,sjsx->ib', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('jibx,ijqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.125 * np.einsum('jibx,jrqx->iqrb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('jibx,jiqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jibx,jrrx->ib', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, slice_o, slice_v, :] += -0.125 * np.einsum('jibx,srrx->ijbs', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jibx,jrrx->ib', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jibx,irrx->jb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('jibx,sjsx->ib', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jibx,jrrx->ib', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.125 * np.einsum('jibx,jiqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.0625 * np.einsum('jibx,ijqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('jibx,ripx->jpbr', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jibx,rirx->jb', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('jibx,jipx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, :, slice_v] += 0.25 * np.einsum('jibx,rsrx->ijsb', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jibx,rirx->jb', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jibx,rjrx->ib', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.25 * np.einsum('jibx,rirx->jb', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('jibx,issx->jb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.125 * np.einsum('jibx,ispx->jpsb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('jibx,ijpx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jibx,issx->jb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.125 * np.einsum('jibx,rjpx->ipbr', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jibx,rjrx->ib', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[:, slice_v] += -0.0625 * np.einsum('jibx,ijpx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.125 * np.einsum('jibx,jspx->ipsb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += 0.125 * np.einsum('jibx,jipx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jibx,jssx->ib', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, slice_o, slice_v, :] += -0.125 * np.einsum('jibx,rssx->ijbr', R2_oo_vc, V2_gg_gc[:, :, :, :])
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jibx,jssx->ib', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.0625 * np.einsum('jibx,issx->jb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[slice_o, slice_v] += -0.125 * np.einsum('jibx,rjrx->ib', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_1body[slice_o, slice_v] += 0.0625 * np.einsum('jibx,jssx->ib', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_1body[:, slice_v] += -0.125 * np.einsum('jibx,jipx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.0625 * np.einsum('jibx,ijpx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_2body[slice_o, slice_o, :, :] += 0.25 * np.einsum('ijsr->ijsr', V_F12_oo_gg[:, :, :, :])
    H_2body[slice_o, slice_o, :, :] += 0.25 * np.einsum('ijrs->ijrs', V_F12_oo_gg[:, :, :, :])
    #  H1_R1  
    H_1body[:, :] += 1.0 * np.einsum('pw,tw->pt', H1_gc[:, :], R1)
    #  H1_R1D  
    H_1body[:, :] += 1.0 * np.einsum('tw,qw->tq', R1, H1_gc[:, :])
    #  V2_R1  
    H_2body[:, :, :, :] += 0.5 * np.einsum('pqrw,tw->pqrt', V2_gg_gc[:, :, :, :], R1)
    H_2body[:, :, :, :] += 0.5 * np.einsum('qpsw,tw->pqts', V2_gg_gc[:, :, :, :], R1)
    #  V2_R1D  
    H_2body[:, :, :, :] += 0.5 * np.einsum('tw,srqw->tqrs', R1, V2_gg_gc[:, :, :, :])
    H_2body[:, :, :, :] += 0.5 * np.einsum('tw,rspw->tpsr', R1, V2_gg_gc[:, :, :, :])
    #  F1_R1_R1  
    #  F1_R1_R1D  
    H_1body[:, :] += 0.5 * np.einsum('uz,zw,tw->ut', R1, F1_cc, R1)
    H_1body[:, :] += -0.5 * np.einsum('uz,tz,tq->uq', R1, R1, F1_gg[:, :])
    #  F1_R1D_R1  
    H_1body[:, :] += -0.5 * np.einsum('pq,qw,uw->pu', F1_gg[:, :], R1, R1)
    H_1body[:, :] += 0.5 * np.einsum('tw,wz,uz->tu', R1, F1_cc, R1)
    #  F1_R1D_R1D  
    #  H1_R2_abxy  
    #  H1_R2D_abxy  
    #  V2_R2_abxy  
    H_2body[:, :, slice_v, slice_v] += 0.25 * np.einsum('pqyx,efxy->pqfe', V2_gg_cc, R2_abxy)
    H_2body[:, :, slice_v, slice_v] += 0.25 * np.einsum('pqxy,efxy->pqef', V2_gg_cc, R2_abxy)
    #  V2_R2D_abxy  
    H_2body[slice_v, slice_v, :, :] += 0.25 * np.einsum('efxy,rsyx->efsr', R2_abxy, V2_gg_cc)
    H_2body[slice_v, slice_v, :, :] += 0.25 * np.einsum('efxy,rsxy->efrs', R2_abxy, V2_gg_cc)
    #  F1_R2_abxy_R2_abxy  
    #  F1_R2_abxy_R2D_abxy  
    #  F1_R2D_abxy_R2_abxy  
    #  F1_R2D_abxy_R2D_abxy  
    #  H1_R2_aixy  
    #  H1_R2D_aixy  
    #  V2_R2_aixy  
    H_2body[:, :, slice_o, slice_v] += 0.25 * np.einsum('pqyx,eixy->pqie', V2_gg_cc, R2_aixy)
    H_2body[:, :, slice_v, slice_o] += 0.25 * np.einsum('pqxy,eixy->pqei', V2_gg_cc, R2_aixy)
    #  V2_R2D_aixy  
    H_2body[slice_v, slice_o, :, :] += 0.25 * np.einsum('eixy,rsyx->eisr', R2_aixy, V2_gg_cc)
    H_2body[slice_v, slice_o, :, :] += 0.25 * np.einsum('eixy,rsxy->eirs', R2_aixy, V2_gg_cc)
    #  F1_R2_aixy_R2_aixy  
    #  F1_R2_aixy_R2D_aixy  
    #  F1_R2D_aixy_R2_aixy  
    #  F1_R2D_aixy_R2D_aixy  
