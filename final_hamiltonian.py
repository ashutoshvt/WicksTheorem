import numpy as np
import input_parameters as inp


# Getting parameters!

ngen = inp.ngen
nvir = inp.nvir
nocc = inp.nocc
V2 = inp.V2
R2 = inp.R2
R2D = inp.R2D
F1 = inp.F1
R22 = inp.R22
R22D = inp.R22D
C = inp.C


# Allocating shapes and memory!!

H_gen_vir_occ_occ = np.zeros((ngen, nvir, nocc, nocc))
H_vir_occ = np.zeros((nvir, nocc))
H_occ_occ_vir_gen = np.zeros((nocc, nocc, nvir, ngen))
H_occ_occ_gen_vir = np.zeros((nocc, nocc, ngen, nvir))
H_occ_vir = np.zeros((nocc, nvir))
H_occ_vir_occ_vir = np.zeros((nocc, nvir, nocc, nvir))
H_occ_vir_vir_occ = np.zeros((nocc, nvir, nvir, nocc))
H_occ_vir_vir_gen = np.zeros((nocc, nvir, nvir, ngen))
H_occ_vir_gen_vir = np.zeros((nocc, nvir, ngen, nvir))
H_occ_occ_gen_occ = np.zeros((nocc, nocc, ngen, nocc))
H_occ_occ_occ_gen = np.zeros((nocc, nocc, nocc, ngen))
H_vir_vir = np.zeros((nvir, nvir))
H_occ_occ = np.zeros((nocc, nocc))
H_occ_gen = np.zeros((nocc, ngen))
H_occ_gen_vir_occ = np.zeros((nocc, ngen, nvir, nocc))
H_occ_gen_occ_vir = np.zeros((nocc, ngen, nocc, nvir))
H_occ_occ_occ_occ = np.zeros((nocc, nocc, nocc, nocc))
H_gen_vir = np.zeros((ngen, nvir))
H_occ_occ_vir_occ = np.zeros((nocc, nocc, nvir, nocc))
H_occ_occ_occ_vir = np.zeros((nocc, nocc, nocc, nvir))
H_gen_vir_occ_vir = np.zeros((ngen, nvir, nocc, nvir))
H_gen_vir_vir_occ = np.zeros((ngen, nvir, nvir, nocc))
H_occ_gen_occ_occ = np.zeros((nocc, ngen, nocc, nocc))
H_gen_occ = np.zeros((ngen, nocc))
H_occ_vir_gen_occ = np.zeros((nocc, nvir, ngen, nocc))
H_occ_vir_occ_gen = np.zeros((nocc, nvir, nocc, ngen))
H_vir_gen = np.zeros((nvir, ngen))
H_occ_vir_occ_occ = np.zeros((nocc, nvir, nocc, nocc))
H_gen_vir_occ_gen = np.zeros((ngen, nvir, nocc, ngen))
H_gen_vir_gen_occ = np.zeros((ngen, nvir, ngen, nocc))
H_gen_gen_occ_occ = np.zeros((ngen, ngen, nocc, nocc))
H_occ_gen_gen_vir = np.zeros((nocc, ngen, ngen, nvir))
H_occ_gen_vir_gen = np.zeros((nocc, ngen, nvir, ngen))
H_occ_occ_gen_gen = np.zeros((nocc, nocc, ngen, ngen))


# Einsum expressions!!

H_gen_vir_occ_occ += 0.5 * np.einsum('px,xbij->pbij', F1, R2)
H_gen_vir_occ_occ += 0.5 * np.einsum('py,ayij->paji', F1, R2)
H_vir_occ += -0.5 * np.einsum('jx,xbij->bi', F1, R2)
H_vir_occ += 1.0 * np.einsum('jy,ayij->ai', F1, R2)
H_vir_occ += 1.0 * np.einsum('ix,xbij->bj', F1, R2)
H_vir_occ += -0.5 * np.einsum('iy,ayij->aj', F1, R2)
H_occ_occ_vir_gen += -0.5 * np.einsum('ijay,yq->ijaq', R2D, F1)
H_occ_occ_gen_vir += -0.5 * np.einsum('ijxb,xq->ijqb', R2D, F1)
H_occ_vir += 0.5 * np.einsum('ijay,yi->ja', R2D, F1)
H_occ_vir += -1.0 * np.einsum('ijxb,xi->jb', R2D, F1)
H_occ_vir += -1.0 * np.einsum('ijay,yj->ia', R2D, F1)
H_occ_vir += 0.5 * np.einsum('ijxb,xj->ib', R2D, F1)
H_occ_vir_occ_vir += -0.25 * np.einsum('klcw,jk,wbij->lbic', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klcw,jk,awij->laci', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klzd,jk,zbij->lbdi', R22D, F1, R2)
H_occ_vir_vir_occ += 0.5 * np.einsum('klzd,jk,azij->ladi', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('ilcw,jq,wbij->lbcq', R22D, F1, R2)
H_occ_vir_gen_vir += -0.25 * np.einsum('ilcw,jq,awij->laqc', R22D, F1, R2)
H_occ_vir_vir_gen += 0.5 * np.einsum('ilzd,jq,zbij->lbdq', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('ilzd,jq,azij->ladq', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klcw,jl,wbij->kbci', R22D, F1, R2)
H_occ_vir_vir_occ += 0.5 * np.einsum('klcw,jl,awij->kaci', R22D, F1, R2)
H_occ_vir_occ_vir += -0.25 * np.einsum('klzd,jl,zbij->kbid', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klzd,jl,azij->kadi', R22D, F1, R2)
H_occ_vir_vir_gen += 0.5 * np.einsum('kicw,jq,wbij->kbcq', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('kicw,jq,awij->kacq', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('kizd,jq,zbij->kbdq', R22D, F1, R2)
H_occ_vir_gen_vir += -0.25 * np.einsum('kizd,jq,azij->kaqd', R22D, F1, R2)
H_occ_occ_gen_occ += 0.25 * np.einsum('jq,klji->klqi', F1, C)
H_occ_occ_occ_gen += 0.25 * np.einsum('jq,klij->kliq', F1, C)
H_vir_vir += -0.25 * np.einsum('kicw,jk,wbij->bc', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('kicw,jk,awij->ac', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('kizd,jk,zbij->bd', R22D, F1, R2)
H_vir_vir += -0.5 * np.einsum('kizd,jk,azij->ad', R22D, F1, R2)
H_occ_occ += 0.5 * np.einsum('jk,klji->li', F1, C)
H_occ_occ += -0.25 * np.einsum('jk,klij->li', F1, C)
H_vir_vir += 0.25 * np.einsum('ilcw,jl,wbij->bc', R22D, F1, R2)
H_vir_vir += -0.25 * np.einsum('ilcw,jl,awij->ac', R22D, F1, R2)
H_vir_vir += -0.5 * np.einsum('ilzd,jl,zbij->bd', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('ilzd,jl,azij->ad', R22D, F1, R2)
H_occ_gen += -0.25 * np.einsum('jq,ilji->lq', F1, C)
H_occ_gen += 0.5 * np.einsum('jq,ilij->lq', F1, C)
H_occ_occ += -0.25 * np.einsum('jl,klji->ki', F1, C)
H_occ_occ += 0.5 * np.einsum('jl,klij->ki', F1, C)
H_occ_gen += 0.5 * np.einsum('jq,kiji->kq', F1, C)
H_occ_gen += -0.25 * np.einsum('jq,kiij->kq', F1, C)
H_occ_vir_gen_vir += -0.25 * np.einsum('jlcw,iq,wbij->lbqc', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('jlcw,iq,awij->lacq', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('jlzd,iq,zbij->lbdq', R22D, F1, R2)
H_occ_vir_vir_gen += 0.5 * np.einsum('jlzd,iq,azij->ladq', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klcw,ik,wbij->lbcj', R22D, F1, R2)
H_occ_vir_occ_vir += -0.25 * np.einsum('klcw,ik,awij->lajc', R22D, F1, R2)
H_occ_vir_vir_occ += 0.5 * np.einsum('klzd,ik,zbij->lbdj', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klzd,ik,azij->ladj', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('kjcw,iq,wbij->kbcq', R22D, F1, R2)
H_occ_vir_vir_gen += 0.5 * np.einsum('kjcw,iq,awij->kacq', R22D, F1, R2)
H_occ_vir_gen_vir += -0.25 * np.einsum('kjzd,iq,zbij->kbqd', R22D, F1, R2)
H_occ_vir_vir_gen += -0.25 * np.einsum('kjzd,iq,azij->kadq', R22D, F1, R2)
H_occ_vir_vir_occ += 0.5 * np.einsum('klcw,il,wbij->kbcj', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klcw,il,awij->kacj', R22D, F1, R2)
H_occ_vir_vir_occ += -0.25 * np.einsum('klzd,il,zbij->kbdj', R22D, F1, R2)
H_occ_vir_occ_vir += -0.25 * np.einsum('klzd,il,azij->kajd', R22D, F1, R2)
H_occ_occ_occ_gen += 0.25 * np.einsum('iq,klji->kljq', F1, C)
H_occ_occ_gen_occ += 0.25 * np.einsum('iq,klij->klqj', F1, C)
H_vir_vir += -0.25 * np.einsum('jlcw,il,wbij->bc', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('jlcw,il,awij->ac', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('jlzd,il,zbij->bd', R22D, F1, R2)
H_vir_vir += -0.5 * np.einsum('jlzd,il,azij->ad', R22D, F1, R2)
H_occ_gen += 0.5 * np.einsum('iq,jlji->lq', F1, C)
H_occ_gen += -0.25 * np.einsum('iq,jlij->lq', F1, C)
H_vir_vir += 0.25 * np.einsum('kjcw,ik,wbij->bc', R22D, F1, R2)
H_vir_vir += -0.25 * np.einsum('kjcw,ik,awij->ac', R22D, F1, R2)
H_vir_vir += -0.5 * np.einsum('kjzd,ik,zbij->bd', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('kjzd,ik,azij->ad', R22D, F1, R2)
H_occ_occ += -0.25 * np.einsum('ik,klji->lj', F1, C)
H_occ_occ += 0.5 * np.einsum('ik,klij->lj', F1, C)
H_occ_gen += -0.25 * np.einsum('iq,kjji->kq', F1, C)
H_occ_gen += 0.5 * np.einsum('iq,kjij->kq', F1, C)
H_occ_occ += 0.5 * np.einsum('il,klji->kj', F1, C)
H_occ_occ += -0.25 * np.einsum('il,klij->kj', F1, C)
H_occ_vir_occ_vir += 0.25 * np.einsum('jlcw,wx,xbij->lbic', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('jlcw,pA,Awij->lpci', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('jlzd,zx,xbij->lbdi', R22D, F1, R2)
H_occ_gen_vir_occ += -0.5 * np.einsum('jlzd,pA,Azij->lpdi', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('ilcw,wx,xbij->lbcj', R22D, F1, R2)
H_occ_gen_occ_vir += 0.25 * np.einsum('ilcw,pA,Awij->lpjc', R22D, F1, R2)
H_occ_vir_vir_occ += -0.5 * np.einsum('ilzd,zx,xbij->lbdj', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('ilzd,pA,Azij->lpdj', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('kjcw,wx,xbij->kbci', R22D, F1, R2)
H_occ_gen_vir_occ += -0.5 * np.einsum('kjcw,pA,Awij->kpci', R22D, F1, R2)
H_occ_vir_occ_vir += 0.25 * np.einsum('kjzd,zx,xbij->kbid', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('kjzd,pA,Azij->kpdi', R22D, F1, R2)
H_occ_vir_vir_occ += -0.5 * np.einsum('kicw,wx,xbij->kbcj', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('kicw,pA,Awij->kpcj', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('kizd,zx,xbij->kbdj', R22D, F1, R2)
H_occ_gen_occ_vir += 0.25 * np.einsum('kizd,pA,Azij->kpjd', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('jicw,wx,xbij->bc', R22D, F1, R2)
H_gen_vir += -0.25 * np.einsum('jicw,pA,Awij->pc', R22D, F1, R2)
H_vir_vir += -0.25 * np.einsum('jizd,zx,xbij->bd', R22D, F1, R2)
H_gen_vir += 0.5 * np.einsum('jizd,pA,Azij->pd', R22D, F1, R2)
H_vir_vir += -0.25 * np.einsum('ijcw,wx,xbij->bc', R22D, F1, R2)
H_gen_vir += 0.25 * np.einsum('ijcw,pA,Awij->pc', R22D, F1, R2)
H_vir_vir += 0.5 * np.einsum('ijzd,zx,xbij->bd', R22D, F1, R2)
H_gen_vir += -0.25 * np.einsum('ijzd,pA,Azij->pd', R22D, F1, R2)
H_occ_vir_occ_vir += 0.25 * np.einsum('ilcw,wy,ayij->lajc', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('ilcw,pB,wBij->lpcj', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('ilzd,zy,ayij->ladj', R22D, F1, R2)
H_occ_gen_vir_occ += -0.5 * np.einsum('ilzd,pB,zBij->lpdj', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('jlcw,wy,ayij->laci', R22D, F1, R2)
H_occ_gen_occ_vir += 0.25 * np.einsum('jlcw,pB,wBij->lpic', R22D, F1, R2)
H_occ_vir_vir_occ += -0.5 * np.einsum('jlzd,zy,ayij->ladi', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('jlzd,pB,zBij->lpdi', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('kicw,wy,ayij->kacj', R22D, F1, R2)
H_occ_gen_vir_occ += -0.5 * np.einsum('kicw,pB,wBij->kpcj', R22D, F1, R2)
H_occ_vir_occ_vir += 0.25 * np.einsum('kizd,zy,ayij->kajd', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('kizd,pB,zBij->kpdj', R22D, F1, R2)
H_occ_vir_vir_occ += -0.5 * np.einsum('kjcw,wy,ayij->kaci', R22D, F1, R2)
H_occ_gen_vir_occ += 0.25 * np.einsum('kjcw,pB,wBij->kpci', R22D, F1, R2)
H_occ_vir_vir_occ += 0.25 * np.einsum('kjzd,zy,ayij->kadi', R22D, F1, R2)
H_occ_gen_occ_vir += 0.25 * np.einsum('kjzd,pB,zBij->kpid', R22D, F1, R2)
H_vir_vir += 0.25 * np.einsum('ijcw,wy,ayij->ac', R22D, F1, R2)
H_gen_vir += -0.25 * np.einsum('ijcw,pB,wBij->pc', R22D, F1, R2)
H_vir_vir += -0.25 * np.einsum('ijzd,zy,ayij->ad', R22D, F1, R2)
H_gen_vir += 0.5 * np.einsum('ijzd,pB,zBij->pd', R22D, F1, R2)
H_vir_vir += -0.25 * np.einsum('jicw,wy,ayij->ac', R22D, F1, R2)
H_gen_vir += 0.25 * np.einsum('jicw,pB,wBij->pc', R22D, F1, R2)
H_vir_vir += 0.5 * np.einsum('jizd,zy,ayij->ad', R22D, F1, R2)
H_gen_vir += -0.25 * np.einsum('jizd,pB,zBij->pd', R22D, F1, R2)
H_occ_occ_vir_occ += 0.25 * np.einsum('klcw,jA,Awij->klci', R22D, F1, R2)
H_occ_occ_occ_vir += 0.25 * np.einsum('klzd,jA,Azij->klid', R22D, F1, R2)
H_occ_vir += -0.25 * np.einsum('ilcw,jA,Awij->lc', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('ilzd,jA,Azij->ld', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('kicw,jA,Awij->kc', R22D, F1, R2)
H_occ_vir += -0.25 * np.einsum('kizd,jA,Azij->kd', R22D, F1, R2)
H_occ_occ_vir_occ += -0.5 * np.einsum('klcw,jB,wBij->klci', R22D, F1, R2)
H_occ_occ_occ_vir += -0.5 * np.einsum('klzd,jB,zBij->klid', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('ilcw,jB,wBij->lc', R22D, F1, R2)
H_occ_vir += -1.0 * np.einsum('ilzd,jB,zBij->ld', R22D, F1, R2)
H_occ_vir += -1.0 * np.einsum('kicw,jB,wBij->kc', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('kizd,jB,zBij->kd', R22D, F1, R2)
H_occ_occ_vir_occ += -0.5 * np.einsum('klcw,iA,Awij->klcj', R22D, F1, R2)
H_occ_occ_occ_vir += -0.5 * np.einsum('klzd,iA,Azij->kljd', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('jlcw,iA,Awij->lc', R22D, F1, R2)
H_occ_vir += -1.0 * np.einsum('jlzd,iA,Azij->ld', R22D, F1, R2)
H_occ_vir += -1.0 * np.einsum('kjcw,iA,Awij->kc', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('kjzd,iA,Azij->kd', R22D, F1, R2)
H_occ_occ_vir_occ += 0.25 * np.einsum('klcw,iB,wBij->klcj', R22D, F1, R2)
H_occ_occ_occ_vir += 0.25 * np.einsum('klzd,iB,zBij->kljd', R22D, F1, R2)
H_occ_vir += -0.25 * np.einsum('jlcw,iB,wBij->lc', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('jlzd,iB,zBij->ld', R22D, F1, R2)
H_occ_vir += 0.5 * np.einsum('kjcw,iB,wBij->kc', R22D, F1, R2)
H_occ_vir += -0.25 * np.einsum('kjzd,iB,zBij->kd', R22D, F1, R2)
H_gen_vir_occ_vir += -0.25 * np.einsum('ilxb,pi,xdkl->pdkb', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('ilxb,pi,cxkl->pcbk', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('ilay,pi,ydkl->pdak', R2D, F1, R22)
H_gen_vir_vir_occ += 0.5 * np.einsum('ilay,pi,cykl->pcak', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('ikxb,pi,xdkl->pdbl', R2D, F1, R22)
H_gen_vir_occ_vir += -0.25 * np.einsum('ikxb,pi,cxkl->pclb', R2D, F1, R22)
H_gen_vir_vir_occ += 0.5 * np.einsum('ikay,pi,ydkl->pdal', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('ikay,pi,cykl->pcal', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijxb,li,xdkl->jdbk', R2D, F1, R22)
H_occ_vir_vir_occ += 0.5 * np.einsum('ijxb,li,cxkl->jcbk', R2D, F1, R22)
H_occ_vir_occ_vir += -0.25 * np.einsum('ijay,li,ydkl->jdka', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijay,li,cykl->jcak', R2D, F1, R22)
H_occ_vir_vir_occ += 0.5 * np.einsum('ijxb,ki,xdkl->jdbl', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijxb,ki,cxkl->jcbl', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijay,ki,ydkl->jdal', R2D, F1, R22)
H_occ_vir_occ_vir += -0.25 * np.einsum('ijay,ki,cykl->jcla', R2D, F1, R22)
H_occ_gen_occ_occ += 0.25 * np.einsum('pi,ijkl->jplk', F1, C)
H_occ_gen_occ_occ += 0.25 * np.einsum('pi,ijlk->jpkl', F1, C)
H_vir_vir += -0.25 * np.einsum('ilxb,ki,xdkl->db', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('ilxb,ki,cxkl->cb', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('ilay,ki,ydkl->da', R2D, F1, R22)
H_vir_vir += -0.5 * np.einsum('ilay,ki,cykl->ca', R2D, F1, R22)
H_gen_occ += 0.5 * np.einsum('pi,ilkl->pk', F1, C)
H_gen_occ += -0.25 * np.einsum('pi,illk->pk', F1, C)
H_vir_vir += 0.25 * np.einsum('ikxb,li,xdkl->db', R2D, F1, R22)
H_vir_vir += -0.25 * np.einsum('ikxb,li,cxkl->cb', R2D, F1, R22)
H_vir_vir += -0.5 * np.einsum('ikay,li,ydkl->da', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('ikay,li,cykl->ca', R2D, F1, R22)
H_gen_occ += -0.25 * np.einsum('pi,ikkl->pl', F1, C)
H_gen_occ += 0.5 * np.einsum('pi,iklk->pl', F1, C)
H_occ_occ += -0.25 * np.einsum('li,ijkl->jk', F1, C)
H_occ_occ += 0.5 * np.einsum('li,ijlk->jk', F1, C)
H_occ_occ += 0.5 * np.einsum('ki,ijkl->jl', F1, C)
H_occ_occ += -0.25 * np.einsum('ki,ijlk->jl', F1, C)
H_gen_vir_occ_vir += -0.25 * np.einsum('ljay,pj,ydkl->pdka', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('ljay,pj,cykl->pcak', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('ljxb,pj,xdkl->pdbk', R2D, F1, R22)
H_gen_vir_vir_occ += 0.5 * np.einsum('ljxb,pj,cxkl->pcbk', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('kjay,pj,ydkl->pdal', R2D, F1, R22)
H_gen_vir_occ_vir += -0.25 * np.einsum('kjay,pj,cykl->pcla', R2D, F1, R22)
H_gen_vir_vir_occ += 0.5 * np.einsum('kjxb,pj,xdkl->pdbl', R2D, F1, R22)
H_gen_vir_vir_occ += -0.25 * np.einsum('kjxb,pj,cxkl->pcbl', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijay,lj,ydkl->idak', R2D, F1, R22)
H_occ_vir_vir_occ += 0.5 * np.einsum('ijay,lj,cykl->icak', R2D, F1, R22)
H_occ_vir_occ_vir += -0.25 * np.einsum('ijxb,lj,xdkl->idkb', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijxb,lj,cxkl->icbk', R2D, F1, R22)
H_occ_vir_vir_occ += 0.5 * np.einsum('ijay,kj,ydkl->idal', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijay,kj,cykl->ical', R2D, F1, R22)
H_occ_vir_vir_occ += -0.25 * np.einsum('ijxb,kj,xdkl->idbl', R2D, F1, R22)
H_occ_vir_occ_vir += -0.25 * np.einsum('ijxb,kj,cxkl->iclb', R2D, F1, R22)
H_occ_gen_occ_occ += 0.25 * np.einsum('pj,ijlk->iplk', F1, C)
H_occ_gen_occ_occ += 0.25 * np.einsum('pj,ijkl->ipkl', F1, C)
H_vir_vir += -0.25 * np.einsum('ljay,kj,ydkl->da', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('ljay,kj,cykl->ca', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('ljxb,kj,xdkl->db', R2D, F1, R22)
H_vir_vir += -0.5 * np.einsum('ljxb,kj,cxkl->cb', R2D, F1, R22)
H_gen_occ += 0.5 * np.einsum('pj,ljlk->pk', F1, C)
H_gen_occ += -0.25 * np.einsum('pj,ljkl->pk', F1, C)
H_vir_vir += 0.25 * np.einsum('kjay,lj,ydkl->da', R2D, F1, R22)
H_vir_vir += -0.25 * np.einsum('kjay,lj,cykl->ca', R2D, F1, R22)
H_vir_vir += -0.5 * np.einsum('kjxb,lj,xdkl->db', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('kjxb,lj,cxkl->cb', R2D, F1, R22)
H_gen_occ += -0.25 * np.einsum('pj,kjlk->pl', F1, C)
H_gen_occ += 0.5 * np.einsum('pj,kjkl->pl', F1, C)
H_occ_occ += -0.25 * np.einsum('lj,ijlk->ik', F1, C)
H_occ_occ += 0.5 * np.einsum('lj,ijkl->ik', F1, C)
H_occ_occ += 0.5 * np.einsum('kj,ijlk->il', F1, C)
H_occ_occ += -0.25 * np.einsum('kj,ijkl->il', F1, C)
H_occ_vir_occ_vir += 0.25 * np.einsum('ljay,yz,zdkl->jdka', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('ljay,yw,cwkl->jcak', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('ljxB,Bq,xdkl->jdqk', R2D, F1, R22)
H_occ_vir_gen_occ += -0.5 * np.einsum('ljxB,Bq,cxkl->jcqk', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('kjay,yz,zdkl->jdal', R2D, F1, R22)
H_occ_vir_occ_vir += 0.25 * np.einsum('kjay,yw,cwkl->jcla', R2D, F1, R22)
H_occ_vir_gen_occ += -0.5 * np.einsum('kjxB,Bq,xdkl->jdql', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('kjxB,Bq,cxkl->jcql', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('ilay,yz,zdkl->idak', R2D, F1, R22)
H_occ_vir_vir_occ += -0.5 * np.einsum('ilay,yw,cwkl->icak', R2D, F1, R22)
H_occ_vir_occ_gen += 0.25 * np.einsum('ilxB,Bq,xdkl->idkq', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('ilxB,Bq,cxkl->icqk', R2D, F1, R22)
H_occ_vir_vir_occ += -0.5 * np.einsum('ikay,yz,zdkl->idal', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('ikay,yw,cwkl->ical', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('ikxB,Bq,xdkl->idql', R2D, F1, R22)
H_occ_vir_occ_gen += 0.25 * np.einsum('ikxB,Bq,cxkl->iclq', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('lkay,yz,zdkl->da', R2D, F1, R22)
H_vir_vir += -0.25 * np.einsum('lkay,yw,cwkl->ca', R2D, F1, R22)
H_vir_gen += -0.25 * np.einsum('lkxB,Bq,xdkl->dq', R2D, F1, R22)
H_vir_gen += 0.5 * np.einsum('lkxB,Bq,cxkl->cq', R2D, F1, R22)
H_vir_vir += -0.25 * np.einsum('klay,yz,zdkl->da', R2D, F1, R22)
H_vir_vir += 0.25 * np.einsum('klay,yw,cwkl->ca', R2D, F1, R22)
H_vir_gen += 0.5 * np.einsum('klxB,Bq,xdkl->dq', R2D, F1, R22)
H_vir_gen += -0.25 * np.einsum('klxB,Bq,cxkl->cq', R2D, F1, R22)
H_occ_vir_occ_gen += 0.25 * np.einsum('ljAy,Aq,ydkl->jdkq', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('ljAy,Aq,cykl->jcqk', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('ljxb,xz,zdkl->jdbk', R2D, F1, R22)
H_occ_vir_vir_occ += -0.5 * np.einsum('ljxb,xw,cwkl->jcbk', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('kjAy,Aq,ydkl->jdql', R2D, F1, R22)
H_occ_vir_occ_gen += 0.25 * np.einsum('kjAy,Aq,cykl->jclq', R2D, F1, R22)
H_occ_vir_vir_occ += -0.5 * np.einsum('kjxb,xz,zdkl->jdbl', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('kjxb,xw,cwkl->jcbl', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('ilAy,Aq,ydkl->idqk', R2D, F1, R22)
H_occ_vir_gen_occ += -0.5 * np.einsum('ilAy,Aq,cykl->icqk', R2D, F1, R22)
H_occ_vir_occ_vir += 0.25 * np.einsum('ilxb,xz,zdkl->idkb', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('ilxb,xw,cwkl->icbk', R2D, F1, R22)
H_occ_vir_gen_occ += -0.5 * np.einsum('ikAy,Aq,ydkl->idql', R2D, F1, R22)
H_occ_vir_gen_occ += 0.25 * np.einsum('ikAy,Aq,cykl->icql', R2D, F1, R22)
H_occ_vir_vir_occ += 0.25 * np.einsum('ikxb,xz,zdkl->idbl', R2D, F1, R22)
H_occ_vir_occ_vir += 0.25 * np.einsum('ikxb,xw,cwkl->iclb', R2D, F1, R22)
H_vir_gen += 0.25 * np.einsum('lkAy,Aq,ydkl->dq', R2D, F1, R22)
H_vir_gen += -0.25 * np.einsum('lkAy,Aq,cykl->cq', R2D, F1, R22)
H_vir_vir += -0.25 * np.einsum('lkxb,xz,zdkl->db', R2D, F1, R22)
H_vir_vir += 0.5 * np.einsum('lkxb,xw,cwkl->cb', R2D, F1, R22)
H_vir_gen += -0.25 * np.einsum('klAy,Aq,ydkl->dq', R2D, F1, R22)
H_vir_gen += 0.25 * np.einsum('klAy,Aq,cykl->cq', R2D, F1, R22)
H_vir_vir += 0.5 * np.einsum('klxb,xz,zdkl->db', R2D, F1, R22)
H_vir_vir += -0.25 * np.einsum('klxb,xw,cwkl->cb', R2D, F1, R22)
H_occ_vir_occ_occ += 0.25 * np.einsum('ijxB,Bi,xdkl->jdkl', R2D, F1, R22)
H_occ_vir_occ_occ += 0.25 * np.einsum('ijxB,Bi,cxkl->jclk', R2D, F1, R22)
H_vir_occ += -0.25 * np.einsum('ilxB,Bi,xdkl->dk', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('ilxB,Bi,cxkl->ck', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('ikxB,Bi,xdkl->dl', R2D, F1, R22)
H_vir_occ += -0.25 * np.einsum('ikxB,Bi,cxkl->cl', R2D, F1, R22)
H_occ_vir_occ_occ += -0.5 * np.einsum('ijAy,Ai,ydkl->jdkl', R2D, F1, R22)
H_occ_vir_occ_occ += -0.5 * np.einsum('ijAy,Ai,cykl->jclk', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('ilAy,Ai,ydkl->dk', R2D, F1, R22)
H_vir_occ += -1.0 * np.einsum('ilAy,Ai,cykl->ck', R2D, F1, R22)
H_vir_occ += -1.0 * np.einsum('ikAy,Ai,ydkl->dl', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('ikAy,Ai,cykl->cl', R2D, F1, R22)
H_occ_vir_occ_occ += -0.5 * np.einsum('ijxB,Bj,xdkl->idkl', R2D, F1, R22)
H_occ_vir_occ_occ += -0.5 * np.einsum('ijxB,Bj,cxkl->iclk', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('ljxB,Bj,xdkl->dk', R2D, F1, R22)
H_vir_occ += -1.0 * np.einsum('ljxB,Bj,cxkl->ck', R2D, F1, R22)
H_vir_occ += -1.0 * np.einsum('kjxB,Bj,xdkl->dl', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('kjxB,Bj,cxkl->cl', R2D, F1, R22)
H_occ_vir_occ_occ += 0.25 * np.einsum('ijAy,Aj,ydkl->idkl', R2D, F1, R22)
H_occ_vir_occ_occ += 0.25 * np.einsum('ijAy,Aj,cykl->iclk', R2D, F1, R22)
H_vir_occ += -0.25 * np.einsum('ljAy,Aj,ydkl->dk', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('ljAy,Aj,cykl->ck', R2D, F1, R22)
H_vir_occ += 0.5 * np.einsum('kjAy,Aj,ydkl->dl', R2D, F1, R22)
H_vir_occ += -0.25 * np.einsum('kjAy,Aj,cykl->cl', R2D, F1, R22)
H_gen_vir_occ_gen += -0.25 * np.einsum('jqrx,xbij->qbir', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('jqry,ayij->qari', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('jqxs,xbij->qbsi', V2, R2)
H_gen_vir_gen_occ += 0.5 * np.einsum('jqys,ayij->qasi', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('iqrx,xbij->qbrj', V2, R2)
H_gen_vir_occ_gen += -0.25 * np.einsum('iqry,ayij->qajr', V2, R2)
H_gen_vir_gen_occ += 0.5 * np.einsum('iqxs,xbij->qbsj', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('iqys,ayij->qasj', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('pjrx,xbij->pbri', V2, R2)
H_gen_vir_gen_occ += 0.5 * np.einsum('pjry,ayij->pari', V2, R2)
H_gen_vir_occ_gen += -0.25 * np.einsum('pjxs,xbij->pbis', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('pjys,ayij->pasi', V2, R2)
H_gen_vir_gen_occ += 0.5 * np.einsum('pirx,xbij->pbrj', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('piry,ayij->parj', V2, R2)
H_gen_vir_gen_occ += -0.25 * np.einsum('pixs,xbij->pbsj', V2, R2)
H_gen_vir_occ_gen += -0.25 * np.einsum('piys,ayij->pajs', V2, R2)
H_vir_gen += -0.25 * np.einsum('jirx,xbij->br', V2, R2)
H_vir_gen += 0.25 * np.einsum('jiry,ayij->ar', V2, R2)
H_vir_gen += 0.25 * np.einsum('jixs,xbij->bs', V2, R2)
H_vir_gen += -0.5 * np.einsum('jiys,ayij->as', V2, R2)
H_vir_gen += 0.25 * np.einsum('ijrx,xbij->br', V2, R2)
H_vir_gen += -0.25 * np.einsum('ijry,ayij->ar', V2, R2)
H_vir_gen += -0.5 * np.einsum('ijxs,xbij->bs', V2, R2)
H_vir_gen += 0.25 * np.einsum('ijys,ayij->as', V2, R2)
H_occ_gen_gen_vir += 0.25 * np.einsum('ijay,yqri->jqra', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijay,pyri->jpar', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijxb,xqri->jqbr', R2D, V2)
H_occ_gen_vir_gen += -0.5 * np.einsum('ijxb,pxri->jpbr', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijay,yqis->jqas', R2D, V2)
H_occ_gen_gen_vir += 0.25 * np.einsum('ijay,pyis->jpsa', R2D, V2)
H_occ_gen_vir_gen += -0.5 * np.einsum('ijxb,xqis->jqbs', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijxb,pxis->jpbs', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijay,yqrj->iqar', R2D, V2)
H_occ_gen_vir_gen += -0.5 * np.einsum('ijay,pyrj->ipar', R2D, V2)
H_occ_gen_gen_vir += 0.25 * np.einsum('ijxb,xqrj->iqrb', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijxb,pxrj->ipbr', R2D, V2)
H_occ_gen_vir_gen += -0.5 * np.einsum('ijay,yqjs->iqas', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijay,pyjs->ipas', R2D, V2)
H_occ_gen_vir_gen += 0.25 * np.einsum('ijxb,xqjs->iqbs', R2D, V2)
H_occ_gen_gen_vir += 0.25 * np.einsum('ijxb,pxjs->ipsb', R2D, V2)
H_gen_vir += 0.25 * np.einsum('ijay,yqji->qa', R2D, V2)
H_gen_vir += -0.25 * np.einsum('ijay,pyji->pa', R2D, V2)
H_gen_vir += -0.25 * np.einsum('ijxb,xqji->qb', R2D, V2)
H_gen_vir += 0.5 * np.einsum('ijxb,pxji->pb', R2D, V2)
H_gen_vir += -0.25 * np.einsum('ijay,yqij->qa', R2D, V2)
H_gen_vir += 0.25 * np.einsum('ijay,pyij->pa', R2D, V2)
H_gen_vir += 0.5 * np.einsum('ijxb,xqij->qb', R2D, V2)
H_gen_vir += -0.25 * np.einsum('ijxb,pxij->pb', R2D, V2)
