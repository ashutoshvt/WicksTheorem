import numpy as np
import input_parameters as inp


# Getting parameters!

ngen = inp.ngen
nvir = inp.nvir
nocc = inp.nocc
V2 = inp.V2
V2_pqrx = inp.V2_pqrx
R2 = inp.R2
F1 = inp.F1
F1_x_x = inp.F1_x_x
C = inp.C


# Allocating shapes and memory!!

H_1body = np.zeros(ngen, ngen)
H_2body = np.zeros(ngen, ngen, ngen, ngen)
slice_o = slice(0, nocc)
slice_v = slice(0, nvir)


# Einsum expressions!!

H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('klcw,jk,jibw->lbic', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,jk,ijaw->laci', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,jk,jibz->lbdi', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('lkdz,jk,ijaz->ladi', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ilcw,jq,jibw->lbcq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('ilcw,jq,ijaw->laqc', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('lidz,jq,jibz->lbdq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('lidz,jq,ijaz->ladq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,jl,jibw->kbci', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('klcw,jl,ijaw->kaci', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('lkdz,jl,jibz->kbid', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,jl,ijaz->kadi', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('kicw,jq,jibw->kbcq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('kicw,jq,ijaw->kacq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ikdz,jq,jibz->kbdq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('ikdz,jq,ijaz->kaqd', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_o, :, slice_o] += 0.25 * np.einsum('jq,klji->klqi', F1[slice_o, :], C)
H_2body[slice_o, slice_o, slice_o, :] += 0.25 * np.einsum('jq,klij->kliq', F1[slice_o, :], C)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('kicw,jk,jibw->bc', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('kicw,jk,ijaw->ac', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ikdz,jk,jibz->bd', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('ikdz,jk,ijaz->ad', R2, F1[slice_o, slice_o], R2)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('jk,klji->li', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('jk,klij->li', F1[slice_o, slice_o], C)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ilcw,jl,jibw->bc', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('ilcw,jl,ijaw->ac', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('lidz,jl,jibz->bd', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('lidz,jl,ijaz->ad', R2, F1[slice_o, slice_o], R2)
H_1body[slice_o, :] += -0.25 * np.einsum('jq,ilji->lq', F1[slice_o, :], C)
H_1body[slice_o, :] += 0.5 * np.einsum('jq,ilij->lq', F1[slice_o, :], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('jl,klji->ki', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('jl,klij->ki', F1[slice_o, slice_o], C)
H_1body[slice_o, :] += 0.5 * np.einsum('jq,kiji->kq', F1[slice_o, :], C)
H_1body[slice_o, :] += -0.25 * np.einsum('jq,kiij->kq', F1[slice_o, :], C)
H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('jlcw,iq,jibw->lbqc', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('jlcw,iq,ijaw->lacq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ljdz,iq,jibz->lbdq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('ljdz,iq,ijaz->ladq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,ik,jibw->lbcj', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('klcw,ik,ijaw->lajc', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('lkdz,ik,jibz->lbdj', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,ik,ijaz->ladj', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('kjcw,iq,jibw->kbcq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('kjcw,iq,ijaw->kacq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('jkdz,iq,jibz->kbqd', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('jkdz,iq,ijaz->kadq', R2, F1[slice_o, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('klcw,il,jibw->kbcj', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,il,ijaw->kacj', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,il,jibz->kbdj', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('lkdz,il,ijaz->kajd', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_o, slice_o, :] += 0.25 * np.einsum('iq,klji->kljq', F1[slice_o, :], C)
H_2body[slice_o, slice_o, :, slice_o] += 0.25 * np.einsum('iq,klij->klqj', F1[slice_o, :], C)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('jlcw,il,jibw->bc', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('jlcw,il,ijaw->ac', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ljdz,il,jibz->bd', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('ljdz,il,ijaz->ad', R2, F1[slice_o, slice_o], R2)
H_1body[slice_o, :] += 0.5 * np.einsum('iq,jlji->lq', F1[slice_o, :], C)
H_1body[slice_o, :] += -0.25 * np.einsum('iq,jlij->lq', F1[slice_o, :], C)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('kjcw,ik,jibw->bc', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('kjcw,ik,ijaw->ac', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('jkdz,ik,jibz->bd', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('jkdz,ik,ijaz->ad', R2, F1[slice_o, slice_o], R2)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('ik,klji->lj', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('ik,klij->lj', F1[slice_o, slice_o], C)
H_1body[slice_o, :] += -0.25 * np.einsum('iq,kjji->kq', F1[slice_o, :], C)
H_1body[slice_o, :] += 0.5 * np.einsum('iq,kjij->kq', F1[slice_o, :], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('il,klji->kj', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('il,klij->kj', F1[slice_o, slice_o], C)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('jlcw,wx,jibx->lbic', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('jlcw,pa,ijaw->lpci', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ljdz,zx,jibx->lbdi', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('ljdz,pa,ijaz->lpdi', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ilcw,wx,jibx->lbcj', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('ilcw,pa,ijaw->lpjc', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('lidz,zx,jibx->lbdj', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('lidz,pa,ijaz->lpdj', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kjcw,wx,jibx->kbci', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('kjcw,pa,ijaw->kpci', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('jkdz,zx,jibx->kbid', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('jkdz,pa,ijaz->kpdi', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('kicw,wx,jibx->kbcj', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('kicw,pa,ijaw->kpcj', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ikdz,zx,jibx->kbdj', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('ikdz,pa,ijaz->kpjd', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('jicw,wx,jibx->bc', R2, F1_x_x, R2)
H_1body[:, slice_v] += -0.25 * np.einsum('jicw,pa,ijaw->pc', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('ijdz,zx,jibx->bd', R2, F1_x_x, R2)
H_1body[:, slice_v] += 0.5 * np.einsum('ijdz,pa,ijaz->pd', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('ijcw,wx,jibx->bc', R2, F1_x_x, R2)
H_1body[:, slice_v] += 0.25 * np.einsum('ijcw,pa,ijaw->pc', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += 0.5 * np.einsum('jidz,zx,jibx->bd', R2, F1_x_x, R2)
H_1body[:, slice_v] += -0.25 * np.einsum('jidz,pa,ijaz->pd', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('ilcw,wy,ijay->lajc', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ilcw,pb,jibw->lpcj', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('lidz,zy,ijay->ladj', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('lidz,pb,jibz->lpdj', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jlcw,wy,ijay->laci', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('jlcw,pb,jibw->lpic', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('ljdz,zy,ijay->ladi', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ljdz,pb,jibz->lpdi', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kicw,wy,ijay->kacj', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('kicw,pb,jibw->kpcj', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('ikdz,zy,ijay->kajd', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ikdz,pb,jibz->kpdj', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('kjcw,wy,ijay->kaci', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('kjcw,pb,jibw->kpci', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jkdz,zy,ijay->kadi', R2, F1_x_x, R2)
H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('jkdz,pb,jibz->kpid', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ijcw,wy,ijay->ac', R2, F1_x_x, R2)
H_1body[:, slice_v] += -0.25 * np.einsum('ijcw,pb,jibw->pc', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('jidz,zy,ijay->ad', R2, F1_x_x, R2)
H_1body[:, slice_v] += 0.5 * np.einsum('jidz,pb,jibz->pd', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('jicw,wy,ijay->ac', R2, F1_x_x, R2)
H_1body[:, slice_v] += 0.25 * np.einsum('jicw,pb,jibw->pc', R2, F1[:, slice_v], R2)
H_1body[slice_v, slice_v] += 0.5 * np.einsum('ijdz,zy,ijay->ad', R2, F1_x_x, R2)
H_1body[:, slice_v] += -0.25 * np.einsum('ijdz,pb,jibz->pd', R2, F1[:, slice_v], R2)
H_2body[slice_o, slice_o, slice_v, slice_o] += 0.25 * np.einsum('klcw,ja,ijaw->klci', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_o, slice_v] += 0.25 * np.einsum('lkdz,ja,ijaz->klid', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -0.25 * np.einsum('ilcw,ja,ijaw->lc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('lidz,ja,ijaz->ld', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('kicw,ja,ijaw->kc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -0.25 * np.einsum('ikdz,ja,ijaz->kd', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_v, slice_o] += -0.5 * np.einsum('klcw,jb,jibw->klci', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_o, slice_v] += -0.5 * np.einsum('lkdz,jb,jibz->klid', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('ilcw,jb,jibw->lc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -1.0 * np.einsum('lidz,jb,jibz->ld', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -1.0 * np.einsum('kicw,jb,jibw->kc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('ikdz,jb,jibz->kd', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_v, slice_o] += -0.5 * np.einsum('klcw,ia,ijaw->klcj', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_o, slice_v] += -0.5 * np.einsum('lkdz,ia,ijaz->kljd', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('jlcw,ia,ijaw->lc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -1.0 * np.einsum('ljdz,ia,ijaz->ld', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -1.0 * np.einsum('kjcw,ia,ijaw->kc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('jkdz,ia,ijaz->kd', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_v, slice_o] += 0.25 * np.einsum('klcw,ib,jibw->klcj', R2, F1[slice_o, slice_v], R2)
H_2body[slice_o, slice_o, slice_o, slice_v] += 0.25 * np.einsum('lkdz,ib,jibz->kljd', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -0.25 * np.einsum('jlcw,ib,jibw->lc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('ljdz,ib,jibz->ld', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += 0.5 * np.einsum('kjcw,ib,jibw->kc', R2, F1[slice_o, slice_v], R2)
H_1body[slice_o, slice_v] += -0.25 * np.einsum('jkdz,ib,jibz->kd', R2, F1[slice_o, slice_v], R2)
H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('libx,pi,lkdx->pdkb', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('libx,pi,klcx->pcbk', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ilay,pi,lkdy->pdak', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ilay,pi,klcy->pcak', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('kibx,pi,lkdx->pdbl', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('kibx,pi,klcx->pclb', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ikay,pi,lkdy->pdal', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ikay,pi,klcy->pcal', R2, F1[:, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,li,lkdx->jdbk', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jibx,li,klcx->jcbk', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('ijay,li,lkdy->jdka', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,li,klcy->jcak', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jibx,ki,lkdx->jdbl', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,ki,klcx->jcbl', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,ki,lkdy->jdal', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('ijay,ki,klcy->jcla', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pi,ijkl->jplk', F1[:, slice_o], C)
H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pi,ijlk->jpkl', F1[:, slice_o], C)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('libx,ki,lkdx->db', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('libx,ki,klcx->cb', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ilay,ki,lkdy->da', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('ilay,ki,klcy->ca', R2, F1[slice_o, slice_o], R2)
H_1body[:, slice_o] += 0.5 * np.einsum('pi,ilkl->pk', F1[:, slice_o], C)
H_1body[:, slice_o] += -0.25 * np.einsum('pi,illk->pk', F1[:, slice_o], C)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('kibx,li,lkdx->db', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('kibx,li,klcx->cb', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('ikay,li,lkdy->da', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ikay,li,klcy->ca', R2, F1[slice_o, slice_o], R2)
H_1body[:, slice_o] += -0.25 * np.einsum('pi,ikkl->pl', F1[:, slice_o], C)
H_1body[:, slice_o] += 0.5 * np.einsum('pi,iklk->pl', F1[:, slice_o], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('li,ijkl->jk', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('li,ijlk->jk', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('ki,ijkl->jl', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('ki,ijlk->jl', F1[slice_o, slice_o], C)
H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('ljay,pj,lkdy->pdka', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ljay,pj,klcy->pcak', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jlbx,pj,lkdx->pdbk', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jlbx,pj,klcx->pcbk', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('kjay,pj,lkdy->pdal', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('kjay,pj,klcy->pcla', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jkbx,pj,lkdx->pdbl', R2, F1[:, slice_o], R2)
H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jkbx,pj,klcx->pcbl', R2, F1[:, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,lj,lkdy->idak', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ijay,lj,klcy->icak', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('jibx,lj,lkdx->idkb', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,lj,klcx->icbk', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ijay,kj,lkdy->idal', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,kj,klcy->ical', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,kj,lkdx->idbl', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('jibx,kj,klcx->iclb', R2, F1[slice_o, slice_o], R2)
H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pj,ijlk->iplk', F1[:, slice_o], C)
H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pj,ijkl->ipkl', F1[:, slice_o], C)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('ljay,kj,lkdy->da', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('ljay,kj,klcy->ca', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('jlbx,kj,lkdx->db', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('jlbx,kj,klcx->cb', R2, F1[slice_o, slice_o], R2)
H_1body[:, slice_o] += 0.5 * np.einsum('pj,ljlk->pk', F1[:, slice_o], C)
H_1body[:, slice_o] += -0.25 * np.einsum('pj,ljkl->pk', F1[:, slice_o], C)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('kjay,lj,lkdy->da', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('kjay,lj,klcy->ca', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += -0.5 * np.einsum('jkbx,lj,lkdx->db', R2, F1[slice_o, slice_o], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('jkbx,lj,klcx->cb', R2, F1[slice_o, slice_o], R2)
H_1body[:, slice_o] += -0.25 * np.einsum('pj,kjlk->pl', F1[:, slice_o], C)
H_1body[:, slice_o] += 0.5 * np.einsum('pj,kjkl->pl', F1[:, slice_o], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('lj,ijlk->ik', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('lj,ijkl->ik', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += 0.5 * np.einsum('kj,ijlk->il', F1[slice_o, slice_o], C)
H_1body[slice_o, slice_o] += -0.25 * np.einsum('kj,ijkl->il', F1[slice_o, slice_o], C)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('ljay,yz,lkdz->jdka', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ljay,yw,klcw->jcak', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('jlbx,bq,lkdx->jdqk', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('jlbx,bq,klcx->jcqk', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kjay,yz,lkdz->jdal', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('kjay,yw,klcw->jcla', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('jkbx,bq,lkdx->jdql', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('jkbx,bq,klcx->jcql', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ilay,yz,lkdz->idak', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('ilay,yw,klcw->icak', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('libx,bq,lkdx->idkq', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('libx,bq,klcx->icqk', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('ikay,yz,lkdz->idal', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ikay,yw,klcw->ical', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('kibx,bq,lkdx->idql', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('kibx,bq,klcx->iclq', R2, F1[slice_v, :], R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('lkay,yz,lkdz->da', R2, F1_x_x, R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('lkay,yw,klcw->ca', R2, F1_x_x, R2)
H_1body[slice_v, :] += -0.25 * np.einsum('klbx,bq,lkdx->dq', R2, F1[slice_v, :], R2)
H_1body[slice_v, :] += 0.5 * np.einsum('klbx,bq,klcx->cq', R2, F1[slice_v, :], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('klay,yz,lkdz->da', R2, F1_x_x, R2)
H_1body[slice_v, slice_v] += 0.25 * np.einsum('klay,yw,klcw->ca', R2, F1_x_x, R2)
H_1body[slice_v, :] += 0.5 * np.einsum('lkbx,bq,lkdx->dq', R2, F1[slice_v, :], R2)
H_1body[slice_v, :] += -0.25 * np.einsum('lkbx,bq,klcx->cq', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('ljay,aq,lkdy->jdkq', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ljay,aq,klcy->jcqk', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jlbx,xz,lkdz->jdbk', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('jlbx,xw,klcw->jcbk', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('kjay,aq,lkdy->jdql', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('kjay,aq,klcy->jclq', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('jkbx,xz,lkdz->jdbl', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jkbx,xw,klcw->jcbl', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ilay,aq,lkdy->idqk', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('ilay,aq,klcy->icqk', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('libx,xz,lkdz->idkb', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('libx,xw,klcw->icbk', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('ikay,aq,lkdy->idql', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ikay,aq,klcy->icql', R2, F1[slice_v, :], R2)
H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kibx,xz,lkdz->idbl', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('kibx,xw,klcw->iclb', R2, F1_x_x, R2)
H_1body[slice_v, :] += 0.25 * np.einsum('lkay,aq,lkdy->dq', R2, F1[slice_v, :], R2)
H_1body[slice_v, :] += -0.25 * np.einsum('lkay,aq,klcy->cq', R2, F1[slice_v, :], R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('klbx,xz,lkdz->db', R2, F1_x_x, R2)
H_1body[slice_v, slice_v] += 0.5 * np.einsum('klbx,xw,klcw->cb', R2, F1_x_x, R2)
H_1body[slice_v, :] += -0.25 * np.einsum('klay,aq,lkdy->dq', R2, F1[slice_v, :], R2)
H_1body[slice_v, :] += 0.25 * np.einsum('klay,aq,klcy->cq', R2, F1[slice_v, :], R2)
H_1body[slice_v, slice_v] += 0.5 * np.einsum('lkbx,xz,lkdz->db', R2, F1_x_x, R2)
H_1body[slice_v, slice_v] += -0.25 * np.einsum('lkbx,xw,klcw->cb', R2, F1_x_x, R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('jibx,bi,lkdx->jdkl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('jibx,bi,klcx->jclk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -0.25 * np.einsum('libx,bi,lkdx->dk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('libx,bi,klcx->ck', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('kibx,bi,lkdx->dl', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -0.25 * np.einsum('kibx,bi,klcx->cl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('ijay,ai,lkdy->jdkl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('ijay,ai,klcy->jclk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('ilay,ai,lkdy->dk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -1.0 * np.einsum('ilay,ai,klcy->ck', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -1.0 * np.einsum('ikay,ai,lkdy->dl', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('ikay,ai,klcy->cl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('jibx,bj,lkdx->idkl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('jibx,bj,klcx->iclk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('jlbx,bj,lkdx->dk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -1.0 * np.einsum('jlbx,bj,klcx->ck', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -1.0 * np.einsum('jkbx,bj,lkdx->dl', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('jkbx,bj,klcx->cl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('ijay,aj,lkdy->idkl', R2, F1[slice_v, slice_o], R2)
H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('ijay,aj,klcy->iclk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -0.25 * np.einsum('ljay,aj,lkdy->dk', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('ljay,aj,klcy->ck', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += 0.5 * np.einsum('kjay,aj,lkdy->dl', R2, F1[slice_v, slice_o], R2)
H_1body[slice_v, slice_o] += -0.25 * np.einsum('kjay,aj,klcy->cl', R2, F1[slice_v, slice_o], R2)
