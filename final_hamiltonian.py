import numpy as np

def construct_transcorr_H(H_1body, H_2body, info):

    # Getting parameters!
    ngen = info[0]
    nocc = info[1]
    nvir = info[2]
    F1_gg = info[3]
    F1_gc = info[4]
    F1_cc = info[5]
    V2_gg_gg = info[6]
    V2_gg_gc = info[7]
    R2_oo_vc = info[8]
    V_F12_oo_gg = info[9]
    X_F12_oo_oo = info[10]
    B_F12_oo_oo = info[11]

    # slices !!
    slice_o = slice(0, nocc)
    slice_v = slice(0, nvir)

    # Einsum expressions!!
    H_2body[:, slice_v, slice_o, slice_o] += 0.5 * np.einsum('px,jibx->pbij', F1_gc[:, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += 0.5 * np.einsum('py,ijay->paji', F1_gc[:, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.5 * np.einsum('jx,jibx->bi', F1_gc[slice_o, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 1.0 * np.einsum('jy,ijay->ai', F1_gc[slice_o, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 1.0 * np.einsum('ix,jibx->bj', F1_gc[slice_o, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.5 * np.einsum('iy,ijay->aj', F1_gc[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, :] += -0.5 * np.einsum('ijay,qy->ijaq', R2_oo_vc, F1_gc[:, :])
    H_2body[slice_o, slice_o, :, slice_v] += -0.5 * np.einsum('jibx,qx->ijqb', R2_oo_vc, F1_gc[:, :])
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('ijay,iy->ja', R2_oo_vc, F1_gc[slice_o, :])
    H_1body[slice_o, slice_v] += -1.0 * np.einsum('jibx,ix->jb', R2_oo_vc, F1_gc[slice_o, :])
    H_1body[slice_o, slice_v] += -1.0 * np.einsum('ijay,jy->ia', R2_oo_vc, F1_gc[slice_o, :])
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('jibx,jx->ib', R2_oo_vc, F1_gc[slice_o, :])
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('klcw,jk,jibw->lbic', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,jk,ijaw->laci', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,jk,jibz->lbdi', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('lkdz,jk,ijaz->ladi', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ilcw,jq,jibw->lbcq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('ilcw,jq,ijaw->laqc', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('lidz,jq,jibz->lbdq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('lidz,jq,ijaz->ladq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,jl,jibw->kbci', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('klcw,jl,ijaw->kaci', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('lkdz,jl,jibz->kbid', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,jl,ijaz->kadi', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('kicw,jq,jibw->kbcq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('kicw,jq,ijaw->kacq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ikdz,jq,jibz->kbdq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('ikdz,jq,ijaz->kaqd', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_o, :, slice_o] += 0.25 * np.einsum('jq,klji->klqi', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, :] += 0.25 * np.einsum('jq,klij->kliq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('kicw,jk,jibw->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('kicw,jk,ijaw->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ikdz,jk,jibz->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('ikdz,jk,ijaz->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('jk,klji->li', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('jk,klij->li', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ilcw,jl,jibw->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('ilcw,jl,ijaw->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('lidz,jl,jibz->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('lidz,jl,ijaz->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_o, :] += -0.25 * np.einsum('jq,ilji->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_o, :] += 0.5 * np.einsum('jq,ilij->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('jl,klji->ki', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('jl,klij->ki', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, :] += 0.5 * np.einsum('jq,kiji->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_o, :] += -0.25 * np.einsum('jq,kiij->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('jlcw,iq,jibw->lbqc', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('jlcw,iq,ijaw->lacq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ljdz,iq,jibz->lbdq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('ljdz,iq,ijaz->ladq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,ik,jibw->lbcj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('klcw,ik,ijaw->lajc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('lkdz,ik,jibz->lbdj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,ik,ijaz->ladj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('kjcw,iq,jibw->kbcq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.5 * np.einsum('kjcw,iq,ijaw->kacq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_v] += -0.25 * np.einsum('jkdz,iq,jibz->kbqd', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('jkdz,iq,ijaz->kadq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('klcw,il,jibw->kbcj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcw,il,ijaw->kacj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdz,il,jibz->kbdj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('lkdz,il,ijaz->kajd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, :] += 0.25 * np.einsum('iq,klji->kljq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_o, :, slice_o] += 0.25 * np.einsum('iq,klij->klqj', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('jlcw,il,jibw->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jlcw,il,ijaw->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ljdz,il,jibz->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('ljdz,il,ijaz->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_o, :] += 0.5 * np.einsum('iq,jlji->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_o, :] += -0.25 * np.einsum('iq,jlij->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('kjcw,ik,jibw->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('kjcw,ik,ijaw->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('jkdz,ik,jibz->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jkdz,ik,ijaz->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('ik,klji->lj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('ik,klij->lj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, :] += -0.25 * np.einsum('iq,kjji->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_o, :] += 0.5 * np.einsum('iq,kjij->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('il,klji->kj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('il,klij->kj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('jlcw,wx,jibx->lbic', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('jlcw,pa,ijaw->lpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ljdz,zx,jibx->lbdi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('ljdz,pa,ijaz->lpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ilcw,wx,jibx->lbcj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('ilcw,pa,ijaw->lpjc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('lidz,zx,jibx->lbdj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('lidz,pa,ijaz->lpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kjcw,wx,jibx->kbci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('kjcw,pa,ijaw->kpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('jkdz,zx,jibx->kbid', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('jkdz,pa,ijaz->kpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('kicw,wx,jibx->kbcj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('kicw,pa,ijaw->kpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ikdz,zx,jibx->kbdj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('ikdz,pa,ijaz->kpjd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('lkij->lkji', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('klij->klij', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jicw,wx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.25 * np.einsum('jicw,pa,ijaw->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('ijdz,zx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.5 * np.einsum('ijdz,pa,ijaz->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('ljij->li', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('jlij->li', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('ijcw,wx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.25 * np.einsum('ijcw,pa,ijaw->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.5 * np.einsum('jidz,zx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.25 * np.einsum('jidz,pa,ijaz->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('liij->lj', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('ilij->lj', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('jkij->ki', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('kjij->ki', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('ikij->kj', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('kiij->kj', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('ilcw,wy,ijay->lajc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ilcw,pb,jibw->lpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('lidz,zy,ijay->ladj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('lidz,pb,jibz->lpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jlcw,wy,ijay->laci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('jlcw,pb,jibw->lpic', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('ljdz,zy,ijay->ladi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ljdz,pb,jibz->lpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kicw,wy,ijay->kacj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.5 * np.einsum('kicw,pb,jibw->kpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('ikdz,zy,ijay->kajd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ikdz,pb,jibz->kpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('kjcw,wy,ijay->kaci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('kjcw,pb,jibw->kpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jkdz,zy,ijay->kadi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += 0.25 * np.einsum('jkdz,pb,jibz->kpid', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('lkji->lkji', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('klji->klij', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ijcw,wy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.25 * np.einsum('ijcw,pb,jibw->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('jidz,zy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.5 * np.einsum('jidz,pb,jibz->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('liji->lj', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('ilji->lj', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('jicw,wy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.25 * np.einsum('jicw,pb,jibw->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.5 * np.einsum('ijdz,zy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.25 * np.einsum('ijdz,pb,jibz->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('ljji->li', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('jlji->li', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('ikji->kj', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('kiji->kj', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('jkji->ki', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('kjji->ki', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_v, slice_o] += 0.25 * np.einsum('klcw,ja,ijaw->klci', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += 0.25 * np.einsum('lkdz,ja,ijaz->klid', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ilcw,ja,ijaw->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('lidz,ja,ijaz->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('kicw,ja,ijaw->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ikdz,ja,ijaz->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.5 * np.einsum('klcw,jb,jibw->klci', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += -0.5 * np.einsum('lkdz,jb,jibz->klid', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('ilcw,jb,jibw->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -1.0 * np.einsum('lidz,jb,jibz->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -1.0 * np.einsum('kicw,jb,jibw->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('ikdz,jb,jibz->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.5 * np.einsum('klcw,ia,ijaw->klcj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += -0.5 * np.einsum('lkdz,ia,ijaz->kljd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('jlcw,ia,ijaw->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -1.0 * np.einsum('ljdz,ia,ijaz->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -1.0 * np.einsum('kjcw,ia,ijaw->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('jkdz,ia,ijaz->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += 0.25 * np.einsum('klcw,ib,jibw->klcj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += 0.25 * np.einsum('lkdz,ib,jibz->kljd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jlcw,ib,jibw->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('ljdz,ib,jibz->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('kjcw,ib,jibw->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jkdz,ib,jibz->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('libx,pi,lkdx->pdkb', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('libx,pi,klcx->pcbk', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ilay,pi,lkdy->pdak', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ilay,pi,klcy->pcak', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('kibx,pi,lkdx->pdbl', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('kibx,pi,klcx->pclb', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ikay,pi,lkdy->pdal', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ikay,pi,klcy->pcal', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,li,lkdx->jdbk', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jibx,li,klcx->jcbk', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('ijay,li,lkdy->jdka', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,li,klcy->jcak', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jibx,ki,lkdx->jdbl', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,ki,klcx->jcbl', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,ki,lkdy->jdal', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('ijay,ki,klcy->jcla', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pi,ijkl->jplk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pi,ijlk->jpkl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('libx,ki,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('libx,ki,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ilay,ki,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('ilay,ki,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[:, slice_o] += 0.5 * np.einsum('pi,ilkl->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[:, slice_o] += -0.25 * np.einsum('pi,illk->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('kibx,li,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('kibx,li,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('ikay,li,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ikay,li,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[:, slice_o] += -0.25 * np.einsum('pi,ikkl->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[:, slice_o] += 0.5 * np.einsum('pi,iklk->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('li,ijkl->jk', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('li,ijlk->jk', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('ki,ijkl->jl', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('ki,ijlk->jl', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('ljay,pj,lkdy->pdka', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ljay,pj,klcy->pcak', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jlbx,pj,lkdx->pdbk', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jlbx,pj,klcx->pcbk', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('kjay,pj,lkdy->pdal', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += -0.25 * np.einsum('kjay,pj,klcy->pcla', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.5 * np.einsum('jkbx,pj,lkdx->pdbl', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jkbx,pj,klcx->pcbl', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,lj,lkdy->idak', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ijay,lj,klcy->icak', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('jibx,lj,lkdx->idkb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,lj,klcx->icbk', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.5 * np.einsum('ijay,kj,lkdy->idal', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,kj,klcy->ical', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,kj,lkdx->idbl', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.25 * np.einsum('jibx,kj,klcx->iclb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pj,ijlk->iplk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_2body[slice_o, :, slice_o, slice_o] += 0.25 * np.einsum('pj,ijkl->ipkl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('ljay,kj,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ljay,kj,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jlbx,kj,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('jlbx,kj,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[:, slice_o] += 0.5 * np.einsum('pj,ljlk->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[:, slice_o] += -0.25 * np.einsum('pj,ljkl->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('kjay,lj,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('kjay,lj,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.5 * np.einsum('jkbx,lj,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jkbx,lj,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[:, slice_o] += -0.25 * np.einsum('pj,kjlk->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[:, slice_o] += 0.5 * np.einsum('pj,kjkl->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('lj,ijlk->ik', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('lj,ijkl->ik', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.5 * np.einsum('kj,ijlk->il', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.25 * np.einsum('kj,ijkl->il', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('ljay,yz,lkdz->jdka', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ljay,yw,klcw->jcak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('jlbx,bq,lkdx->jdqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('jlbx,bq,klcx->jcqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kjay,yz,lkdz->jdal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('kjay,yw,klcw->jcla', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('jkbx,bq,lkdx->jdql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('jkbx,bq,klcx->jcql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ilay,yz,lkdz->idak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('ilay,yw,klcw->icak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('libx,bq,lkdx->idkq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('libx,bq,klcx->icqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('ikay,yz,lkdz->idal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ikay,yw,klcw->ical', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('kibx,bq,lkdx->idql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('kibx,bq,klcx->iclq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('jikl->jilk', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('jilk->jilk', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('lkay,yz,lkdz->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('lkay,yw,klcw->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('klbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.5 * np.einsum('klbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('jlkl->jk', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('jllk->jk', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('klay,yz,lkdz->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('klay,yw,klcw->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, :] += 0.5 * np.einsum('lkbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('lkbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('jkkl->jl', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('jklk->jl', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('likl->ik', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('lilk->ik', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('kikl->il', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('kilk->il', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('ljay,aq,lkdy->jdkq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ljay,aq,klcy->jcqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jlbx,xz,lkdz->jdbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('jlbx,xw,klcw->jcbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('kjay,aq,lkdy->jdql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += 0.25 * np.einsum('kjay,aq,klcy->jclq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.5 * np.einsum('jkbx,xz,lkdz->jdbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jkbx,xw,klcw->jcbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ilay,aq,lkdy->idqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('ilay,aq,klcy->icqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('libx,xz,lkdz->idkb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('libx,xw,klcw->icbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.5 * np.einsum('ikay,aq,lkdy->idql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ikay,aq,klcy->icql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kibx,xz,lkdz->idbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.25 * np.einsum('kibx,xw,klcw->iclb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('ijlk->ijkl', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_o, slice_o] += -0.25 * np.einsum('ijkl->ijkl', B_F12_oo_oo)
    H_1body[slice_v, :] += 0.25 * np.einsum('lkay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('lkay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('klbx,xz,lkdz->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.5 * np.einsum('klbx,xw,klcw->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('ljlk->jk', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('ljkl->jk', B_F12_oo_oo)
    H_1body[slice_v, :] += -0.25 * np.einsum('klay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('klay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.5 * np.einsum('lkbx,xz,lkdz->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('lkbx,xw,klcw->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('kjlk->jl', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('kjkl->jl', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('illk->ik', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('ilkl->ik', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += -0.5 * np.einsum('iklk->il', B_F12_oo_oo)
    H_1body[slice_o, slice_o] += 0.25 * np.einsum('ikkl->il', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('jibx,bi,lkdx->jdkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('jibx,bi,klcx->jclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('libx,bi,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('libx,bi,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('kibx,bi,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('kibx,bi,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('ijay,ai,lkdy->jdkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('ijay,ai,klcy->jclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('ilay,ai,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -1.0 * np.einsum('ilay,ai,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -1.0 * np.einsum('ikay,ai,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('ikay,ai,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('jibx,bj,lkdx->idkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.5 * np.einsum('jibx,bj,klcx->iclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('jlbx,bj,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -1.0 * np.einsum('jlbx,bj,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -1.0 * np.einsum('jkbx,bj,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('jkbx,bj,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('ijay,aj,lkdy->idkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('ijay,aj,klcy->iclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('ljay,aj,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('ljay,aj,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('kjay,aj,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('kjay,aj,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('jqrx,jibx->qbir', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('jqry,ijay->qari', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('qjsx,jibx->qbsi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('qjsy,ijay->qasi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('iqrx,jibx->qbrj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('iqry,ijay->qajr', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('qisx,jibx->qbsj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('qisy,ijay->qasj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('pjrx,jibx->pbri', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('pjry,ijay->pari', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('jpsx,jibx->pbis', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('jpsy,ijay->pasi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('pirx,jibx->pbrj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('piry,ijay->parj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('ipsx,jibx->pbsj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('ipsy,ijay->pajs', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, :, slice_o, slice_o] += 0.25 * np.einsum('ijqp->pqji', V_F12_oo_gg[:, :, :, :])
    H_2body[:, :, slice_o, slice_o] += 0.25 * np.einsum('ijpq->pqij', V_F12_oo_gg[:, :, :, :])
    H_1body[slice_v, :] += -0.25 * np.einsum('jirx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('jiry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('ijsx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.5 * np.einsum('ijsy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[:, slice_o] += 0.5 * np.einsum('ijqj->qi', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_o] += -0.25 * np.einsum('ijjq->qi', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_v, :] += 0.25 * np.einsum('ijrx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('ijry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.5 * np.einsum('jisx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('jisy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[:, slice_o] += -0.25 * np.einsum('ijqi->qj', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_o] += 0.5 * np.einsum('ijiq->qj', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[:, slice_o] += -0.25 * np.einsum('ijjp->pi', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[:, slice_o] += 0.5 * np.einsum('ijpj->pi', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_o] += 0.5 * np.einsum('ijip->pj', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[:, slice_o] += -0.25 * np.einsum('ijpi->pj', V_F12_oo_gg[:, :, :, slice_o])
    H_2body[slice_o, :, :, slice_v] += 0.25 * np.einsum('ijay,irqy->jqra', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('ijay,ripy->jpar', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('jibx,irqx->jqbr', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.5 * np.einsum('jibx,ripx->jpbr', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('ijay,siqy->jqas', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += 0.25 * np.einsum('ijay,ispy->jpsa', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.5 * np.einsum('jibx,siqx->jqbs', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('jibx,ispx->jpbs', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('ijay,jrqy->iqar', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.5 * np.einsum('ijay,rjpy->ipar', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += 0.25 * np.einsum('jibx,jrqx->iqrb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('jibx,rjpx->ipbr', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.5 * np.einsum('ijay,sjqy->iqas', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('ijay,jspy->ipas', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.25 * np.einsum('jibx,sjqx->iqbs', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += 0.25 * np.einsum('jibx,jspx->ipsb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, slice_o, :, :] += -0.25 * np.einsum('ijsr->ijsr', V_F12_oo_gg[:, :, :, :])
    H_2body[slice_o, slice_o, :, :] += -0.25 * np.einsum('ijrs->ijrs', V_F12_oo_gg[:, :, :, :])
    H_1body[:, slice_v] += 0.25 * np.einsum('ijay,ijqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += -0.25 * np.einsum('ijay,jipy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += -0.25 * np.einsum('jibx,ijqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.5 * np.einsum('jibx,jipx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[slice_o, :] += -0.5 * np.einsum('ijir->jr', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_o, :] += 0.25 * np.einsum('ijri->jr', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_v] += -0.25 * np.einsum('ijay,jiqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.25 * np.einsum('ijay,ijpy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.5 * np.einsum('jibx,jiqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += -0.25 * np.einsum('jibx,ijpx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[slice_o, :] += 0.25 * np.einsum('ijsi->js', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[slice_o, :] += -0.5 * np.einsum('ijis->js', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_o, :] += 0.25 * np.einsum('ijjr->ir', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_o, :] += -0.5 * np.einsum('ijrj->ir', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[slice_o, :] += -0.5 * np.einsum('ijsj->is', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[slice_o, :] += 0.25 * np.einsum('ijjs->is', V_F12_oo_gg[:, :, slice_o, :])
