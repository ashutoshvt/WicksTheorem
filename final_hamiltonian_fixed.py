import numpy as np


def construct_transcorr_H(H_1body, H_2body, info):

    # Getting parameters!
    ngen = info[0]
    nocc = info[1]
    nvir = info[2]
    H1_gg = info[3]
    H1_gc = info[4]
    F1_gg = info[5]
    F1_gc = info[6]
    F1_cc = info[7]
    V2_gg_gg = info[8]
    V2_gg_gc = info[9]
    R2_oo_vc = info[10]
    V_F12_oo_gg = info[11]
    X_F12_oo_oo = info[12]
    B_F12_oo_oo = info[13]

    # slices !!
    slice_o = slice(0, nocc)
    slice_v = slice(0, nvir)

    # Einsum expressions!!
    H_2body[:, slice_v, slice_o, slice_o] += 0.5 * np.einsum('tx,jibx->tbij', H1_gc[:, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_o] += 0.5 * np.einsum('ty,ijay->taji', H1_gc[:, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.5 * np.einsum('jx,jibx->bi', H1_gc[slice_o, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 1.0 * np.einsum('jy,ijay->ai', H1_gc[slice_o, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += 1.0 * np.einsum('ix,jibx->bj', H1_gc[slice_o, :], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.5 * np.einsum('iy,ijay->aj', H1_gc[slice_o, :], R2_oo_vc)
# ----------------------------------------------------
    H_2body[slice_o, slice_o, slice_v, :] += 0.5 * np.einsum('ijay,uy->ijau', R2_oo_vc, H1_gc[:, :])
    H_2body[slice_o, slice_o, :, slice_v] += 0.5 * np.einsum('jibx,ux->ijub', R2_oo_vc, H1_gc[:, :])
    H_1body[slice_o, slice_v] += -0.5 * np.einsum('ijay,iy->ja', R2_oo_vc, H1_gc[slice_o, :])
    H_1body[slice_o, slice_v] += 1.0 * np.einsum('jibx,ix->jb', R2_oo_vc, H1_gc[slice_o, :])
    H_1body[slice_o, slice_v] += 1.0 * np.einsum('ijay,jy->ia', R2_oo_vc, H1_gc[slice_o, :])
    H_1body[slice_o, slice_v] += -0.5 * np.einsum('jibx,jx->ib', R2_oo_vc, H1_gc[slice_o, :])
# ----------------------------------------------------
# ----------------------------------------------------
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('klcz,jk,jibz->lbic', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('klcz,jk,ijaz->laci', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('lkdw,jk,jibw->lbdi', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdw,jk,ijaw->ladi', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('ilcz,jq,jibz->lbcq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_v] += 0.125 * np.einsum('ilcz,jq,ijaz->laqc', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('lidw,jq,jibw->lbdq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('lidw,jq,ijaw->ladq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('klcz,jl,jibz->kbci', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcz,jl,ijaz->kaci', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('lkdw,jl,jibw->kbid', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('lkdw,jl,ijaw->kadi', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('kicz,jq,jibz->kbcq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('kicz,jq,ijaz->kacq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('ikdw,jq,jibw->kbdq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_v] += 0.125 * np.einsum('ikdw,jq,ijaw->kaqd', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    # H_2body[slice_o, slice_o, :, slice_o] += -0.125 * np.einsum('jq,klji->klqi', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_2body[slice_o, slice_o, slice_o, :] += -0.125 * np.einsum('jq,klij->kliq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('kicz,jk,jibz->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('kicz,jk,ijaz->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ikdw,jk,jibw->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ikdw,jk,ijaw->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('jk,klji->li', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('jk,klij->li', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ilcz,jl,jibz->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('ilcz,jl,ijaz->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('lidw,jl,jibw->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('lidw,jl,ijaw->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[slice_o, :] += 0.125 * np.einsum('jq,ilji->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_1body[slice_o, :] += -0.25 * np.einsum('jq,ilij->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('jl,klji->ki', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('jl,klij->ki', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, :] += -0.25 * np.einsum('jq,kiji->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_1body[slice_o, :] += 0.125 * np.einsum('jq,kiij->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_2body[slice_o, slice_v, :, slice_v] += 0.125 * np.einsum('jlcz,iq,jibz->lbqc', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('jlcz,iq,ijaz->lacq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('ljdw,iq,jibw->lbdq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('ljdw,iq,ijaw->ladq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('klcz,ik,jibz->lbcj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('klcz,ik,ijaz->lajc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('lkdw,ik,jibw->lbdj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('lkdw,ik,ijaw->ladj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('kjcz,iq,jibz->kbcq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += -0.25 * np.einsum('kjcz,iq,ijaz->kacq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_v] += 0.125 * np.einsum('jkdw,iq,jibw->kbqd', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, :] += 0.125 * np.einsum('jkdw,iq,ijaw->kadq', R2_oo_vc, F1_gg[slice_o, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('klcz,il,jibz->kbcj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('klcz,il,ijaz->kacj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('lkdw,il,jibw->kbdj', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('lkdw,il,ijaw->kajd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_2body[slice_o, slice_o, slice_o, :] += -0.125 * np.einsum('iq,klji->kljq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_2body[slice_o, slice_o, :, slice_o] += -0.125 * np.einsum('iq,klij->klqj', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('jlcz,il,jibz->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('jlcz,il,ijaz->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ljdw,il,jibw->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ljdw,il,ijaw->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[slice_o, :] += -0.25 * np.einsum('iq,jlji->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_1body[slice_o, :] += 0.125 * np.einsum('iq,jlij->lq', F1_gg[slice_o, :], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('kjcz,ik,jibz->bc', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('kjcz,ik,ijaz->ac', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jkdw,ik,jibw->bd', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('jkdw,ik,ijaw->ad', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('ik,klji->lj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('ik,klij->lj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, :] += 0.125 * np.einsum('iq,kjji->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_1body[slice_o, :] += -0.25 * np.einsum('iq,kjij->kq', F1_gg[slice_o, :], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('il,klji->kj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('il,klij->kj', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('jlcz,zx,jibx->lbic', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('jlcz,pa,ijaz->lpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ljdw,wx,jibx->lbdi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('ljdw,pa,ijaw->lpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ilcz,zx,jibx->lbcj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.125 * np.einsum('ilcz,pa,ijaz->lpjc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('lidw,wx,jibx->lbdj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('lidw,pa,ijaw->lpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('kjcz,zx,jibx->kbci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('kjcz,pa,ijaz->kpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('jkdw,wx,jibx->kbid', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('jkdw,pa,ijaw->kpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kicz,zx,jibx->kbcj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('kicz,pa,ijaz->kpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ikdw,wx,jibx->kbdj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.125 * np.einsum('ikdw,pa,ijaw->kpjd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('lkij->lkji', B_F12_oo_oo)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('klij->klij', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('jicz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.125 * np.einsum('jicz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('ijdw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.25 * np.einsum('ijdw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('ljij->li', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('jlij->li', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('ijcz,zx,jibx->bc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.125 * np.einsum('ijcz,pa,ijaz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('jidw,wx,jibx->bd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.125 * np.einsum('jidw,pa,ijaw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('liij->lj', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('ilij->lj', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('jkij->ki', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('kjij->ki', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('ikij->kj', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('kiij->kj', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('ilcz,zy,ijay->lajc', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('ilcz,pb,jibz->lpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('lidw,wy,ijay->ladj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('lidw,pb,jibw->lpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('jlcz,zy,ijay->laci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.125 * np.einsum('jlcz,pb,jibz->lpic', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ljdw,wy,ijay->ladi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('ljdw,pb,jibw->lpdi', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('kicz,zy,ijay->kacj', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += 0.25 * np.einsum('kicz,pb,jibz->kpcj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('ikdw,wy,ijay->kajd', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('ikdw,pb,jibw->kpdj', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('kjcz,zy,ijay->kaci', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_v, slice_o] += -0.125 * np.einsum('kjcz,pb,jibz->kpci', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('jkdw,wy,ijay->kadi', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, :, slice_o, slice_v] += -0.125 * np.einsum('jkdw,pb,jibw->kpid', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('lkji->lkji', B_F12_oo_oo)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('klji->klij', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ijcz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.125 * np.einsum('ijcz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('jidw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.25 * np.einsum('jidw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('liji->lj', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('ilji->lj', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('jicz,zy,ijay->ac', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += -0.125 * np.einsum('jicz,pb,jibz->pc', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('ijdw,wy,ijay->ad', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[:, slice_v] += 0.125 * np.einsum('ijdw,pb,jibw->pd', R2_oo_vc, F1_gg[:, slice_v], R2_oo_vc)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('ljji->li', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('jlji->li', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('ikji->kj', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('kiji->kj', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('jkji->ki', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('kjji->ki', B_F12_oo_oo)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.125 * np.einsum('klcz,ja,ijaz->klci', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += -0.125 * np.einsum('lkdw,ja,ijaw->klid', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ilcz,ja,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('lidw,ja,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('kicz,ja,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('ikdw,ja,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += 0.25 * np.einsum('klcz,jb,jibz->klci', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += 0.25 * np.einsum('lkdw,jb,jibw->klid', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ilcz,jb,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('lidw,jb,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('kicz,jb,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ikdw,jb,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += 0.25 * np.einsum('klcz,ia,ijaz->klcj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += 0.25 * np.einsum('lkdw,ia,ijaw->kljd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jlcz,ia,ijaz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('ljdw,ia,ijaw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.5 * np.einsum('kjcz,ia,ijaz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('jkdw,ia,ijaw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_v, slice_o] += -0.125 * np.einsum('klcz,ib,jibz->klcj', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_2body[slice_o, slice_o, slice_o, slice_v] += -0.125 * np.einsum('lkdw,ib,jibw->kljd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jlcz,ib,jibz->lc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('ljdw,ib,jibw->ld', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += -0.25 * np.einsum('kjcz,ib,jibz->kc', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
    H_1body[slice_o, slice_v] += 0.125 * np.einsum('jkdw,ib,jibw->kd', R2_oo_vc, F1_gg[slice_o, slice_v], R2_oo_vc)
# ----------------------------------------------------
    H_2body[:, slice_v, slice_o, slice_v] += 0.125 * np.einsum('libx,pi,lkdx->pdkb', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('libx,pi,klcx->pcbk', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ilay,pi,lkdy->pdak', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ilay,pi,klcy->pcak', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('kibx,pi,lkdx->pdbl', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += 0.125 * np.einsum('kibx,pi,klcx->pclb', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ikay,pi,lkdy->pdal', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ikay,pi,klcy->pcal', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jibx,li,lkdx->jdbk', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,li,klcx->jcbk', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('ijay,li,lkdy->jdka', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ijay,li,klcy->jcak', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jibx,ki,lkdx->jdbl', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jibx,ki,klcx->jcbl', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ijay,ki,lkdy->jdal', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('ijay,ki,klcy->jcla', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_2body[slice_o, :, slice_o, slice_o] += -0.125 * np.einsum('pi,ijkl->jplk', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_2body[slice_o, :, slice_o, slice_o] += -0.125 * np.einsum('pi,ijlk->jpkl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('libx,ki,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('libx,ki,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ilay,ki,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ilay,ki,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[:, slice_o] += -0.25 * np.einsum('pi,ilkl->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_1body[:, slice_o] += 0.125 * np.einsum('pi,illk->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('kibx,li,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('kibx,li,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('ikay,li,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ikay,li,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[:, slice_o] += 0.125 * np.einsum('pi,ikkl->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_1body[:, slice_o] += -0.25 * np.einsum('pi,iklk->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('li,ijkl->jk', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('li,ijlk->jk', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('ki,ijkl->jl', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('ki,ijlk->jl', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_2body[:, slice_v, slice_o, slice_v] += 0.125 * np.einsum('ljay,pj,lkdy->pdka', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ljay,pj,klcy->pcak', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jlbx,pj,lkdx->pdbk', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jlbx,pj,klcx->pcbk', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('kjay,pj,lkdy->pdal', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_o, slice_v] += 0.125 * np.einsum('kjay,pj,klcy->pcla', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += -0.25 * np.einsum('jkbx,pj,lkdx->pdbl', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[:, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jkbx,pj,klcx->pcbl', R2_oo_vc, F1_gg[:, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ijay,lj,lkdy->idak', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,lj,klcy->icak', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('jibx,lj,lkdx->idkb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jibx,lj,klcx->icbk', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.25 * np.einsum('ijay,kj,lkdy->idal', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('ijay,kj,klcy->ical', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.125 * np.einsum('jibx,kj,lkdx->idbl', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += 0.125 * np.einsum('jibx,kj,klcx->iclb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_2body[slice_o, :, slice_o, slice_o] += -0.125 * np.einsum('pj,ijlk->iplk', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_2body[slice_o, :, slice_o, slice_o] += -0.125 * np.einsum('pj,ijkl->ipkl', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('ljay,kj,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('ljay,kj,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('jlbx,kj,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jlbx,kj,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[:, slice_o] += -0.25 * np.einsum('pj,ljlk->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_1body[:, slice_o] += 0.125 * np.einsum('pj,ljkl->pk', F1_gg[:, slice_o], X_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('kjay,lj,lkdy->da', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('kjay,lj,klcy->ca', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.25 * np.einsum('jkbx,lj,lkdx->db', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('jkbx,lj,klcx->cb', R2_oo_vc, F1_gg[slice_o, slice_o], R2_oo_vc)
    # H_1body[:, slice_o] += 0.125 * np.einsum('pj,kjlk->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_1body[:, slice_o] += -0.25 * np.einsum('pj,kjkl->pl', F1_gg[:, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('lj,ijlk->ik', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('lj,ijkl->ik', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.25 * np.einsum('kj,ijlk->il', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.125 * np.einsum('kj,ijkl->il', F1_gg[slice_o, slice_o], X_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('ljay,yw,lkdw->jdka', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ljay,yz,klcz->jcak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('jlbx,bq,lkdx->jdqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('jlbx,bq,klcx->jcqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('kjay,yw,lkdw->jdal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('kjay,yz,klcz->jcla', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('jkbx,bq,lkdx->jdql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('jkbx,bq,klcx->jcql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ilay,yw,lkdw->idak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ilay,yz,klcz->icak', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.125 * np.einsum('libx,bq,lkdx->idkq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('libx,bq,klcx->icqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('ikay,yw,lkdw->idal', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('ikay,yz,klcz->ical', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('kibx,bq,lkdx->idql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.125 * np.einsum('kibx,bq,klcx->iclq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('jikl->jilk', B_F12_oo_oo)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('jilk->jilk', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('lkay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('lkay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('klbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('klbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('jlkl->jk', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('jllk->jk', B_F12_oo_oo)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('klay,yw,lkdw->da', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.125 * np.einsum('klay,yz,klcz->ca', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('lkbx,bq,lkdx->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('lkbx,bq,klcx->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('jkkl->jl', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('jklk->jl', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('likl->ik', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('lilk->ik', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('kikl->il', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('kilk->il', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, :] += -0.125 * np.einsum('ljay,aq,lkdy->jdkq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('ljay,aq,klcy->jcqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('jlbx,xw,lkdw->jdbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jlbx,xz,klcz->jcbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('kjay,aq,lkdy->jdql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, :] += -0.125 * np.einsum('kjay,aq,klcy->jclq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += 0.25 * np.einsum('jkbx,xw,lkdw->jdbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('jkbx,xz,klcz->jcbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('ilay,aq,lkdy->idqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ilay,aq,klcy->icqk', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('libx,xw,lkdw->idkb', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('libx,xz,klcz->icbk', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += 0.25 * np.einsum('ikay,aq,lkdy->idql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, :, slice_o] += -0.125 * np.einsum('ikay,aq,klcy->icql', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_v, slice_o] += -0.125 * np.einsum('kibx,xw,lkdw->idbl', R2_oo_vc, F1_cc, R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_v] += -0.125 * np.einsum('kibx,xz,klcz->iclb', R2_oo_vc, F1_cc, R2_oo_vc)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('ijlk->ijkl', B_F12_oo_oo)
    # H_2body[slice_o, slice_o, slice_o, slice_o] += 0.125 * np.einsum('ijkl->ijkl', B_F12_oo_oo)
    H_1body[slice_v, :] += -0.125 * np.einsum('lkay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.125 * np.einsum('lkay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('klbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('klbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('ljlk->jk', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('ljkl->jk', B_F12_oo_oo)
    H_1body[slice_v, :] += 0.125 * np.einsum('klay,aq,lkdy->dq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.125 * np.einsum('klay,aq,klcy->cq', R2_oo_vc, F1_gg[slice_v, :], R2_oo_vc)
    H_1body[slice_v, slice_v] += -0.25 * np.einsum('lkbx,xw,lkdw->db', R2_oo_vc, F1_cc, R2_oo_vc)
    H_1body[slice_v, slice_v] += 0.125 * np.einsum('lkbx,xz,klcz->cb', R2_oo_vc, F1_cc, R2_oo_vc)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('kjlk->jl', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('kjkl->jl', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('illk->ik', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('ilkl->ik', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += 0.25 * np.einsum('iklk->il', B_F12_oo_oo)
    # H_1body[slice_o, slice_o] += -0.125 * np.einsum('ikkl->il', B_F12_oo_oo)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.125 * np.einsum('jibx,bi,lkdx->jdkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.125 * np.einsum('jibx,bi,klcx->jclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('libx,bi,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('libx,bi,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('kibx,bi,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('kibx,bi,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('ijay,ai,lkdy->jdkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('ijay,ai,klcy->jclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('ilay,ai,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('ilay,ai,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('ikay,ai,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('ikay,ai,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('jibx,bj,lkdx->idkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += 0.25 * np.einsum('jibx,bj,klcx->iclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('jlbx,bj,lkdx->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('jlbx,bj,klcx->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.5 * np.einsum('jkbx,bj,lkdx->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('jkbx,bj,klcx->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.125 * np.einsum('ijay,aj,lkdy->idkl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_2body[slice_o, slice_v, slice_o, slice_o] += -0.125 * np.einsum('ijay,aj,klcy->iclk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('ljay,aj,lkdy->dk', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('ljay,aj,klcy->ck', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += -0.25 * np.einsum('kjay,aj,lkdy->dl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
    H_1body[slice_v, slice_o] += 0.125 * np.einsum('kjay,aj,klcy->cl', R2_oo_vc, F1_gg[slice_v, slice_o], R2_oo_vc)
# ----------------------------------------------------
# ----------------------------------------------------
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('jqrx,jibx->qbir', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('jqry,ijay->qari', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('qjsx,jibx->qbsi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('qjsy,ijay->qasi', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('iqrx,jibx->qbrj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('iqry,ijay->qajr', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('qisx,jibx->qbsj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('qisy,ijay->qasj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('pjrx,jibx->pbri', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('pjry,ijay->pari', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('jpsx,jibx->pbis', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('jpsy,ijay->pasi', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += 0.5 * np.einsum('pirx,jibx->pbrj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('piry,ijay->parj', V2_gg_gc[:, slice_o, :, :], R2_oo_vc)
    H_2body[:, slice_v, :, slice_o] += -0.25 * np.einsum('ipsx,jibx->pbsj', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, slice_v, slice_o, :] += -0.25 * np.einsum('ipsy,ijay->pajs', V2_gg_gc[slice_o, :, :, :], R2_oo_vc)
    H_2body[:, :, slice_o, slice_o] += 0.25 * np.einsum('ijqp->pqji', V_F12_oo_gg[:, :, :, :])
    H_2body[:, :, slice_o, slice_o] += 0.25 * np.einsum('ijpq->pqij', V_F12_oo_gg[:, :, :, :])
    H_1body[slice_v, :] += -0.25 * np.einsum('jirx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('jiry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('ijsx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.5 * np.einsum('ijsy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    # H_1body[:, slice_o] += 0.5 * np.einsum('ijqj->qi', V_F12_oo_gg[:, :, :, slice_o])
    # H_1body[:, slice_o] += -0.25 * np.einsum('ijjq->qi', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_v, :] += 0.25 * np.einsum('ijrx,jibx->br', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.25 * np.einsum('ijry,ijay->ar', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += -0.5 * np.einsum('jisx,jibx->bs', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    H_1body[slice_v, :] += 0.25 * np.einsum('jisy,ijay->as', V2_gg_gc[slice_o, slice_o, :, :], R2_oo_vc)
    '''
    H_1body[:, slice_o] += -0.25 * np.einsum('ijqi->qj', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_o] += 0.5 * np.einsum('ijiq->qj', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[:, slice_o] += -0.25 * np.einsum('ijjp->pi', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[:, slice_o] += 0.5 * np.einsum('ijpj->pi', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_o] += 0.5 * np.einsum('ijip->pj', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[:, slice_o] += -0.25 * np.einsum('ijpi->pj', V_F12_oo_gg[:, :, :, slice_o])
    '''
# ----------------------------------------------------
    H_2body[slice_o, :, :, slice_v] += -0.25 * np.einsum('ijay,irqy->jqra', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('ijay,ripy->jpar', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('jibx,irqx->jqbr', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.5 * np.einsum('jibx,ripx->jpbr', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('ijay,siqy->jqas', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.25 * np.einsum('ijay,ispy->jpsa', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.5 * np.einsum('jibx,siqx->jqbs', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('jibx,ispx->jpbs', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('ijay,jrqy->iqar', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.5 * np.einsum('ijay,rjpy->ipar', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.25 * np.einsum('jibx,jrqx->iqrb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('jibx,rjpx->ipbr', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += 0.5 * np.einsum('ijay,sjqy->iqas', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('ijay,jspy->ipas', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, :, slice_v, :] += -0.25 * np.einsum('jibx,sjqx->iqbs', R2_oo_vc, V2_gg_gc[:, slice_o, :, :])
    H_2body[slice_o, :, :, slice_v] += -0.25 * np.einsum('jibx,jspx->ipsb', R2_oo_vc, V2_gg_gc[slice_o, :, :, :])
    H_2body[slice_o, slice_o, :, :] += 0.25 * np.einsum('ijsr->ijsr', V_F12_oo_gg[:, :, :, :])
    H_2body[slice_o, slice_o, :, :] += 0.25 * np.einsum('ijrs->ijrs', V_F12_oo_gg[:, :, :, :])
    H_1body[:, slice_v] += -0.25 * np.einsum('ijay,ijqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.25 * np.einsum('ijay,jipy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.25 * np.einsum('jibx,ijqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += -0.5 * np.einsum('jibx,jipx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    # H_1body[slice_o, :] += 0.5 * np.einsum('ijir->jr', V_F12_oo_gg[:, :, slice_o, :])
    # H_1body[slice_o, :] += -0.25 * np.einsum('ijri->jr', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[:, slice_v] += 0.25 * np.einsum('ijay,jiqy->qa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += -0.25 * np.einsum('ijay,ijpy->pa', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += -0.5 * np.einsum('jibx,jiqx->qb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    H_1body[:, slice_v] += 0.25 * np.einsum('jibx,ijpx->pb', R2_oo_vc, V2_gg_gc[slice_o, slice_o, :, :])
    '''
    H_1body[slice_o, :] += -0.25 * np.einsum('ijsi->js', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[slice_o, :] += 0.5 * np.einsum('ijis->js', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_o, :] += -0.25 * np.einsum('ijjr->ir', V_F12_oo_gg[:, :, slice_o, :])
    H_1body[slice_o, :] += 0.5 * np.einsum('ijrj->ir', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[slice_o, :] += 0.5 * np.einsum('ijsj->is', V_F12_oo_gg[:, :, :, slice_o])
    H_1body[slice_o, :] += -0.25 * np.einsum('ijjs->is', V_F12_oo_gg[:, :, slice_o, :])
    '''
# ----------------------------------------------------
